{"version":3,"sources":["graphql/schema.ts","graphql/resolvers.ts","graphql/server.ts","tools/type-checks.ts","functional-firebase-admin/core/image.ts","functional-firebase-admin/core/crud.ts","functional-firebase-admin/core/firestore/doc.ts","functional-firebase-admin/core/firestore/collection.ts","functional-firebase-admin/core/firestore/snapshot.ts","functional-firebase-admin/core/firestore/firestore.ts","functional-firebase-admin/core/attachToDefault.ts","functional-firebase-admin/core/firestore/index.ts","functional-firebase-admin/core/storage/service-object.ts","functional-firebase-admin/core/storage/file.ts","functional-firebase-admin/core/storage/bucket.ts","functional-firebase-admin/core/storage/storage.ts","functional-firebase-admin/core/storage/index.ts","functional-firebase-admin/core/extendedApp.ts","functional-firebase-admin/core/index.ts","tools/errors.ts","tools/numbers.ts","contants.ts","tools/uploadBusboy.ts","tools/ascii.ts","models/photos.ts","functions.ts"],"names":[],"mappings":"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","file":"functions.js","sourceRoot":"..\\src","sourcesContent":["import {gql} from 'apollo-server-express';\r\n\r\nconst schema = gql`\r\n  type Query {\r\n    \"A simple type for getting started!\"\r\n    hello: String\r\n    \r\n    \"Get a mooieman\"\r\n    mooieman: String\r\n\r\n    \"Get a fraaievrouw\"\r\n    fraaievrouw: String\r\n\r\n    \"Get the amount of mooiemannen or fraaievrouwen\"\r\n    count: String\r\n\r\n    \"Get all the files of type mooieman or fraaievrouw\"\r\n    files: String\r\n    \r\n  }\r\n`;\r\n\r\nexport default schema;","\r\nconst resolverFunctions = ({fileService}:any) => ({\r\n    Query: {\r\n        hello: () => 'world',\r\n        mooieman: () => 'mooieman',\r\n        fraaievrouw: () => 'fraaievrouw',\r\n        count: () => 'count',\r\n        files: ()=>fileService.getFiles(),\r\n    }\r\n});\r\n\r\nexport default resolverFunctions;","  \r\nimport express = require('express');\r\nimport {ApolloServer} from 'apollo-server-express';\r\n\r\nimport schema from './schema';\r\nimport resolvers from './resolvers';\r\nfunction gqlServer(dependencies = {}) {\r\n  const app = express();\r\n  const apolloServer = new ApolloServer({\r\n    typeDefs: schema,\r\n    resolvers: resolvers(dependencies),\r\n    // Enable graphiql gui\r\n    introspection: true,\r\n    playground: true\r\n  });\r\n\r\n  apolloServer.applyMiddleware({app, path: '/', cors: true});\r\n\r\n  return app;\r\n}\r\n\r\nexport default gqlServer;","export const typeOf = <T>(val: T) => Object.prototype.toString.call(val)\r\nexport const typeError = <NAME>(name: NAME, fallbackType: string, valType: string, msg?:string) => new TypeError(`${msg ? `\\n(${msg})`: ''}${name} should be of type ${fallbackType}, but is: ${valType}`)\r\n\r\nexport const typeCHeck = <T extends {}>(obj: Partial<T>) => <NAME extends keyof T, F>(name: NAME, fallback: F) => {\r\n    if (!obj.hasOwnProperty(name))\r\n        return fallback\r\n    else if (!obj[name])\r\n        return undefined // allow the disabling of some features by explicitly setting it to some falsey value\r\n    throw (typeError(name, `${typeOf(fallback)} or falsey`, typeOf(obj[name])))\r\n}\r\n\r\n// loose properties may be set to a falsey value to disable a specific feature, but must not differ in type otherwise\r\nexport const typeCheckFalsey = <T extends {}>(obj: Partial<T>) => <NAME extends keyof T, F>(name: NAME, fallback: F) => {\r\n    if (!obj.hasOwnProperty(name))\r\n        return fallback\r\n    else if (!obj[name])\r\n        return undefined // allow the disabling of some features by explicitly setting it to some falsey value\r\n    throw (typeError(name, `${typeOf(fallback)} or falsey`, typeOf(obj[name])))\r\n}\r\n\r\n// strict properties may be set, but must share the type with the fallback property.\r\nexport const typeCheckStrict = <T extends {}>(obj: Partial<T>) => <NAME extends keyof T, F>(name: NAME, fallback: F) : T[NAME]|F => {\r\n    if (obj.hasOwnProperty(name)) {\r\n        if (typeOf(fallback) === typeOf(obj[name]))\r\n            return obj[name] as T[NAME]; // this value will do\r\n        else throw (typeError(name, typeOf(fallback), typeOf(obj[name])));\r\n    }\r\n    return fallback\r\n}\r\n\r\n// required properties must share it's type with the fallback property and must always be set\r\nexport const typeCheckRequire = <T extends {}>(obj: Partial<T>) => <NAME extends keyof T, F>(name: NAME, fallback: F): T[NAME]|F => {\r\n    if (obj.hasOwnProperty(name))\r\n        if (typeOf(fallback) === typeOf(obj[name]))\r\n            return obj[name] as T[NAME]; // this value will do\r\n    throw (typeError(name, typeOf(fallback), typeOf(obj[name])));\r\n}\r\n","import { typeCheckRequire, typeCheckStrict } from \"~tools/type-checks\"\r\nimport { Bucket } from \"./storage\";\r\nimport { Duplex, Writable } from \"stream\";\r\nimport { crud } from \"./crud\";\r\nimport { pipe, then, pipeWith, isNil, curry } from \"ramda\"\r\nimport {type,number,string,object} from 'io-ts'\r\n\r\ninterface Version {\r\n    md5: string,\r\n    fileName: string,\r\n    filePath: string,\r\n    fileMime: string,\r\n    ext: string,\r\n    width: number,\r\n    height: number,\r\n    upload: Buffer | Duplex,\r\n}\r\nconst Version = type({\r\n    md5: string,\r\n    fileName: string,\r\n    filePath: string,\r\n    fileMime: string,\r\n    ext: string,\r\n    width: number,\r\n    height: number,\r\n    upload: object,\r\n})\r\n\r\ninterface Image extends Version {\r\n    originalFileName: string,\r\n    originalFilePath: string,\r\n    originalFileMime: string,\r\n    score: number,\r\n    type: string,\r\n    number: number,\r\n}\r\n\r\nconst validateVersion = <DATA extends Version>(mode = typeCheckRequire) => (data: Partial<DATA>) => {\r\n    const strictness = mode(data)\r\n    strictness('md5', '')\r\n    strictness('fileName', '')\r\n    strictness('filePath', '')\r\n    strictness('fileMime', '')\r\n    strictness('ext', '')\r\n    return data as DATA;\r\n}\r\nconst validateImage = <DATA extends Image>(mode = typeCheckRequire) => {\r\n    const ver = validateVersion(mode)\r\n    return (data: Partial<DATA>) => {\r\n        ver(data)\r\n        const strictness = mode(data)\r\n        strictness('originalFileName', '')\r\n        strictness('originalFilePath', '')\r\n        strictness('originalFileMime', '')\r\n        return data as DATA;\r\n    }\r\n}\r\nconst validateCreateImage = validateImage()\r\nconst validatePartialImage = validateImage(typeCheckStrict)\r\nconst validateCreateVersion = validateVersion()\r\nconst validatePartialVersion = validateVersion(typeCheckStrict)\r\n\r\nconst pipeWhileNotNil = pipeWith((f, res?) => isNil(res) ? res : f(res));\r\nconst handleStream = (bucket: Bucket) => async (image: Version): Promise<Omit<Version, 'upload'>> => {\r\n    const writeStream: Writable = bucket(image.filePath).createWriteStream({ contentType: image.fileMime });\r\n    const { upload, ...restImage } = image\r\n    if (Buffer.isBuffer(upload))\r\n        writeStream.end(upload)\r\n    else if (typeof upload.read === 'function')\r\n        writeStream.pipe(upload)\r\n    else\r\n        throw (new TypeError('no upload'))\r\n    await new Promise((resolve, reject) => {\r\n        writeStream.on('finish', resolve)\r\n        writeStream.on('error', reject)\r\n        writeStream.on('info', info => {\r\n            console.log('info', Object.keys(info))\r\n            if (info.width)\r\n                image.width = info.width\r\n            if (info.height)\r\n                image.height = info.height\r\n        })\r\n    })\r\n    return restImage;\r\n}\r\n\r\nexport const getCount = (bucket: Bucket) => (crud: crud) => async (data: Omit<Image, 'number'>) => ({\r\n    ...data,\r\n    number: await crud.getCount()\r\n})\r\n\r\nexport const create = (bucket: Bucket) => (crud: crud) =>\r\n    pipe(\r\n        getCount(bucket)(crud),\r\n        then(\r\n            pipe(\r\n                validateCreateImage,\r\n                handleStream(bucket),\r\n                crud.create\r\n            )\r\n        )\r\n    )\r\n\r\nexport const createVersion = (bucket: Bucket) => (crud: crud) =>\r\n    pipe(\r\n        validateCreateVersion,\r\n        handleStream(bucket),\r\n    )\r\n\r\nexport const read = (bucket: Bucket) => (crud: crud) =>\r\n    pipeWhileNotNil([\r\n        crud.read,\r\n        then(pipe(\r\n            validatePartialImage,\r\n            image => ({\r\n                file: bucket(`${image.type}/${image.type}${image.number}.${image.ext || 'webp'}`),\r\n                ...image,\r\n            })\r\n        ))\r\n    ])\r\n\r\nexport const update = (bucket: Bucket) => (crud: crud) =>\r\n    pipe(\r\n        validatePartialImage,\r\n        crud.update,\r\n    )\r\n\r\nconst remove = (bucket: Bucket) => (crud: crud) => crud.delete\r\nexport { remove as delete }\r\n\r\n\r\n\r\nexport default read","import { Collection, Doc } from \"./firestore\"\r\nimport { Timestamp, DocumentData, UpdateData, Precondition } from \"@google-cloud/firestore\";\r\nimport { pipe, then } from 'ramda'\r\n\r\nexport interface crud {\r\n    create: <DATA extends DocumentData>(optionst: DATA) => Promise<FirebaseFirestore.WriteResult>,\r\n    update: <DATA extends UpdateData, PRECONDITION extends Precondition>(data: DATA, precondition?: PRECONDITION) => Promise<FirebaseFirestore.WriteResult>,\r\n    read: () => Promise<DocumentData | undefined>\r\n    delete: (precondition?: Precondition) => Promise<FirebaseFirestore.WriteResult>\r\n    getCount: () => Promise<number>\r\n    sub: (documentPath: string, collectionPath: string) => crud\r\n}\r\n\r\nexport const getCount = (Stats: Collection) =>\r\n    (Doc: Doc) => pipe(\r\n        Stats(Doc.parent.id).get,\r\n        then(v => Number(v.get('count'))),\r\n    )\r\n\r\nconst addCreatedTimestamp = (data: UpdateData) => ({\r\n    ...data,\r\n    created: Timestamp.now()\r\n})\r\nexport const create = (Stats: Collection) =>\r\n    (Doc: Doc) => pipe(\r\n        addCreatedTimestamp,\r\n        Doc.create,\r\n        then(async (WriteResult) => {\r\n            await Stats(Doc.parent.id).incrementField('count', 1);\r\n            return WriteResult;\r\n        }),\r\n    )\r\n\r\nexport const read = (_: Collection) =>\r\n    (Doc: Doc) => pipe(\r\n        Doc.get,\r\n        then(v => v.data()),\r\n    )\r\n\r\nconst addUpdatedimestamp = (data: UpdateData) => ({\r\n    ...data,\r\n    updated: Timestamp.now()\r\n})\r\nexport const update = (_: Collection) =>\r\n    (Doc: Doc) => pipe(\r\n        addUpdatedimestamp,\r\n        (data) => Doc.update(data)\r\n    )\r\n\r\nconst remove = (Stats: Collection) =>\r\n    (Doc: Doc) => pipe(\r\n        Doc.delete,\r\n        then(async (WriteResult) => {\r\n            await Stats(Doc.parent.id).incrementField('count', -1);\r\n            return WriteResult;\r\n        })\r\n    )\r\n\r\nexport { remove as delete }\r\nconst subDoc = (Doc: Doc) => (documentPath: string, collectionPath: string) => Doc(collectionPath)(documentPath)\r\nexport const newCrud = (Stats: Collection) => (Doc: Doc): crud => ({\r\n    getCount: getCount(Stats)(Doc),\r\n    create: create(Stats)(Doc),\r\n    delete: remove(Stats)(Doc),\r\n    update: update(Stats)(Doc),\r\n    read: read(Stats)(Doc),\r\n    sub: sub(Stats)(Doc),\r\n})\r\nexport const sub = (Stats: Collection) =>\r\n    (Doc: Doc) => pipe(\r\n        subDoc(Doc),\r\n        newCrud(Stats)\r\n    )\r\n\r\nexport default read","import DocumentReference = FirebaseFirestore.DocumentReference\r\nimport UpdateData = FirebaseFirestore.UpdateData\r\nimport Precondition = FirebaseFirestore.Precondition\r\nimport WriteResult = FirebaseFirestore.WriteResult\r\nimport FieldPath = FirebaseFirestore.FieldPath\r\n\r\ntype ofDoc<X extends keyof DocumentReference> = (doc: DocumentReference) => DocumentReference[X]\r\nexport interface MappedDocumentReference extends DocumentReference {\r\n    // no changes needed\r\n}\r\nexport const get: ofDoc<'get'> = (doc) => () => doc.get();\r\nexport const set: ofDoc<'set'> = (doc) => (data, options) => doc.set(data, options);\r\nexport const create: ofDoc<'create'> = (doc) => (data) => doc.create(data);\r\n// data: UpdateData, precondition?: Precondition | undefined\r\n\r\nfunction _update<DATA extends UpdateData, PRECONDITION extends Precondition>(doc: DocumentReference): (data: DATA, precondition?: PRECONDITION) => Promise<WriteResult>;\r\nfunction _update<FIELD extends string | FieldPath, VALUE extends any>(doc: DocumentReference): (field: FIELD, value: VALUE, ...moreFieldsOrPrecondition: any[]) => Promise<WriteResult>;\r\nfunction _update(doc: DocumentReference) {\r\n    return <FIELD,VALUE>(field: FIELD, value?: VALUE, ...moreFieldsOrPrecondition: any[]) => {\r\n        if (!value)\r\n            return doc.update(field);\r\n        if (!moreFieldsOrPrecondition.length)\r\n            return doc.update(field, value);\r\n        if (typeof field === 'string')\r\n            return doc.update(field, value, ...moreFieldsOrPrecondition);\r\n        return doc.update(field, value);\r\n    }\r\n}\r\nexport const update: ofDoc<'update'> = _update\r\n\r\nconst remove: ofDoc<'delete'> = (doc) => (precondition) => doc.delete(precondition);\r\nexport { remove as delete }; // can't write delete otherwise\r\n\r\n\r\nexport const collection: ofDoc<'collection'> = (doc) => (collectionPath) => doc.collection(collectionPath);\r\nexport const listCollections: ofDoc<'listCollections'> = (doc) => () => doc.listCollections();\r\nexport const isEqual: ofDoc<'isEqual'> = (doc) => (other) => doc.isEqual(other);\r\nexport const onSnapshot: ofDoc<'onSnapshot'> = (doc) => (onNext, onError) => doc.onSnapshot(onNext, onError);\r\n\r\nexport const id: ofDoc<'id'> = (doc) => doc.id;\r\nexport const firestore: ofDoc<'firestore'> = (doc) => doc.firestore;\r\nexport const parent: ofDoc<'parent'> = (doc) => doc.parent;\r\nexport const path: ofDoc<'path'> = (doc) => doc.path;\r\n\r\n\r\nexport default collection;","import CollectionReference = FirebaseFirestore.CollectionReference\r\nimport FieldPath = FirebaseFirestore.FieldPath\r\nimport DocumentData = FirebaseFirestore.DocumentData\r\nimport WhereFilterOp = FirebaseFirestore.WhereFilterOp\r\nimport QuerySnapshot = FirebaseFirestore.QuerySnapshot\r\nimport OrderByDirection = FirebaseFirestore.OrderByDirection\r\n\r\nexport interface MappedCollectionReference extends CollectionReference {\r\n    // no extensions yet\r\n}\r\nexport type ofCollection<X extends keyof CollectionReference> = (collection: CollectionReference) => CollectionReference[X]\r\nexport const doc:ofCollection<'doc'> = (collection: CollectionReference) => (documentPath?: string) => {\r\n    if (documentPath)\r\n        return collection.doc(documentPath)\r\n    return collection.doc();\r\n}\r\nexport const add:ofCollection<'add'> = (collection) => (data: DocumentData) => collection.add(data); // we force a string for documentPath\r\nexport const where:ofCollection<'where'> = (collection) => (fieldPath: string|FieldPath, opStr: WhereFilterOp, value: any) => collection.where(fieldPath, opStr, value);\r\nexport const select:ofCollection<'select'> = (collection) => (...field: (string | FieldPath)[]) => collection.select(...field);\r\nexport const offset:ofCollection<'offset'> = (collection) => (offset: number) => collection.offset(offset);\r\nexport const limit:ofCollection<'limit'> = (collection) => (limit: number) => collection.limit(limit);\r\nexport const startAt:ofCollection<'startAt'> = (collection) => (...fieldValues: any[]) => collection.startAt(...fieldValues);\r\nexport const startAfter:ofCollection<'startAfter'> = (collection) => (...fieldValues: any[]) => collection.startAfter(...fieldValues);\r\nexport const endAt:ofCollection<'endAt'> = (collection) => (...fieldValues: any[]) => collection.endAt(...fieldValues);\r\nexport const endBefore:ofCollection<'endBefore'> = (collection) => (...fieldValues: any[]) => collection.endBefore(...fieldValues);\r\nexport const onSnapshot:ofCollection<'onSnapshot'> = (collection) => (onNext: (snapshot: QuerySnapshot) => void, onError?: (error: Error) => void) => collection.onSnapshot(onNext, onError);\r\nexport const isEqual:ofCollection<'isEqual'> = (collection) => (other: CollectionReference) => collection.isEqual(other);\r\nexport const orderBy:ofCollection<'orderBy'> = (collection) => (fieldPath: string|FieldPath, directionStr?: OrderByDirection) => collection.orderBy(fieldPath, directionStr);\r\nexport const stream:ofCollection<'stream'> = (collection) => () => collection.stream();\r\nexport const get:ofCollection<'get'> = (collection) => () => collection.get();\r\nexport const listDocuments:ofCollection<'listDocuments'> = (collection) => () => collection.listDocuments();\r\nexport const id:ofCollection<'id'> = (collection) => collection.id\r\nexport const parent:ofCollection<'parent'> = (collection) => collection.parent\r\nexport const path:ofCollection<'path'> = (collection) => collection.path\r\nexport const firestore:ofCollection<'firestore'> = (collection) => collection.firestore\r\nexport default doc;","import DocumentSnapshot = FirebaseFirestore.DocumentSnapshot\r\nimport FieldPath = FirebaseFirestore.FieldPath\r\nexport interface MappedDocumentSnapshot extends DocumentSnapshot {\r\n    // no changes needed\r\n}\r\nexport const data = (snapshot:  DocumentSnapshot) => ()=> snapshot.data()\r\nexport const get = (snapshot:  DocumentSnapshot) => (fieldPath: string|FieldPath)=> snapshot.get(fieldPath)\r\nexport const isEqual = (snapshot:  DocumentSnapshot) => (other: DocumentSnapshot)=> snapshot.isEqual(other)\r\nexport const exists = (snapshot: DocumentSnapshot) => snapshot.exists\r\nexport const updateTime = (snapshot: DocumentSnapshot) => snapshot.updateTime\r\nexport const readTime = (snapshot: DocumentSnapshot) => snapshot.readTime\r\nexport const createTime = (snapshot: DocumentSnapshot) => snapshot.createTime\r\nexport const id = (snapshot: DocumentSnapshot) => snapshot.id\r\nexport const ref = (snapshot: DocumentSnapshot) => snapshot.ref\r\nexport default data","\r\nimport Settings = FirebaseFirestore.Settings;\r\nimport Firestore = FirebaseFirestore.Firestore;\r\nimport DocumentReference = FirebaseFirestore.DocumentReference;\r\nimport ReadOptions = FirebaseFirestore.ReadOptions;\r\nimport Transaction = FirebaseFirestore.Transaction;\r\nexport interface MappedFirestore extends Firestore {\r\n    // no changes needed\r\n}\r\n\r\nexport const collection = (firestore:Firestore)=>(collectionPath:string)=>firestore.collection(collectionPath)\r\nexport const settings = (firestore:Firestore)=>(settings: Settings)=>firestore.settings(settings);\r\nexport const doc = (firestore:Firestore)=>(documentPath: string)=>firestore.doc(documentPath);\r\nexport const collectionGroup = (firestore:Firestore)=>(collectionId: string)=>firestore.collectionGroup(collectionId);\r\nexport const getAll = (firestore:Firestore)=>(...documentRefsOrReadOptions: Array<DocumentReference|ReadOptions>)=>firestore.getAll(...documentRefsOrReadOptions);\r\nexport const listCollections = (firestore:Firestore)=>()=>firestore.listCollections();\r\nexport const runTransaction = (firestore:Firestore)=><T>(updateFunction: (transaction: Transaction) => Promise<T>, transactionOptions?:{maxAttempts?: number}) => firestore.runTransaction(updateFunction, transactionOptions)\r\nexport const batch = (firestore:Firestore)=>()=>firestore.batch();\r\n\r\nexport default collection;","export function attachToDefault<T extends { default: CallableFunction }>(spec: T): T & T['default'] {\r\n    return Object.assign(\r\n        spec.default,\r\n        spec\r\n    )\r\n}\r\nexport default attachToDefault","import * as doc from \"./doc\"\r\nimport * as collection from \"./collection\"\r\nimport * as snapshot from \"./snapshot\"\r\nimport * as firestore from \"./firestore\"\r\nimport { applySpec, pipe } from 'ramda';\r\nimport attachToDefault from \"../attachToDefault\";\r\n\r\nimport CollectionReference = FirebaseFirestore.CollectionReference\r\nimport DocumentData = FirebaseFirestore.DocumentData\r\nimport DocumentReference = FirebaseFirestore.DocumentReference\r\nimport DocumentSnapshot = FirebaseFirestore.DocumentSnapshot\r\n\r\nexport type Snapshot = snapshot.MappedDocumentSnapshot & (() => DocumentData | undefined)\r\nexport type Doc = doc.MappedDocumentReference & ((collectionPath: string) => Collection)\r\nexport type Collection = collection.MappedCollectionReference & ((documentPath: string) => Doc)\r\nexport type Firestore = firestore.MappedFirestore & ((collectionPath: string) => Collection)\r\n\r\nexport {doc,collection,snapshot,firestore};\r\n\r\nexport const Snapshot: (s:DocumentSnapshot)=>Snapshot = pipe(\r\n    applySpec(snapshot),\r\n    attachToDefault\r\n);\r\nexport const Doc: (d:DocumentReference)=>Doc = pipe(\r\n    applySpec(doc),\r\n    (spec) => ({\r\n        ...spec,\r\n        default: pipe(spec.default, Collection)\r\n    }),\r\n    attachToDefault\r\n);\r\nexport const Collection: (d:CollectionReference)=>Collection = pipe(\r\n    applySpec(collection),\r\n    (spec) => ({\r\n        ...spec,\r\n        default: pipe(spec.default, Doc)\r\n    }),\r\n    attachToDefault\r\n);\r\nexport const Firestore: (d:FirebaseFirestore.Firestore)=>Firestore = pipe(\r\n    applySpec(firestore),\r\n    (spec) => ({\r\n        ...spec,\r\n        default: pipe(spec.default, Collection)\r\n    }),\r\n    attachToDefault\r\n);\r\n\r\nexport default Firestore","import {\r\n    ExistsOptions, ExistsCallback, CreateOptions, CreateCallback, CreateResponse, DeleteOptions, GetResponse, GetConfig,\r\n    GetMetadataOptions, MetadataResponse, ServiceObject, \r\n} from '@google-cloud/common/build/src/service-object';\r\nimport {\r\n    File,Bucket\r\n} from 'firebase-admin/node_modules/@google-cloud/storage';\r\nimport {\r\n    DecorateRequestOptions, BodyResponseCallback, MetadataCallback, Metadata, ResponseBody, DeleteCallback,\r\n    InstanceResponseCallback\r\n} from '@google-cloud/common';\r\nimport * as r from 'teeny-request'\r\nexport function _create<T extends ServiceObject>(serviceObject: T): (callback: CreateCallback<T>) => void;\r\nexport function _create<T extends ServiceObject>(serviceObject: T): (options: CreateOptions, callback: CreateCallback<T>) => void\r\nexport function _create<T extends ServiceObject>(serviceObject: T): (options?: CreateOptions) => Promise<CreateResponse<T>>;\r\nexport function _create<T extends ServiceObject>(serviceObject: T) {\r\n    return (options?: CreateOptions, callback?: CreateCallback<T>) => {\r\n        if (!options)\r\n            return serviceObject.create();\r\n        if (!callback)\r\n            return serviceObject.create(options);\r\n        return serviceObject.create(options, callback);\r\n    }\r\n}\r\n\r\nexport function _request<T extends ServiceObject>(serviceObject: T): (reqOpts: DecorateRequestOptions) => Promise<[ResponseBody, Metadata]>;\r\nexport function _request<T extends ServiceObject>(serviceObject: T): (reqOpts: DecorateRequestOptions, callback: BodyResponseCallback) => void\r\nexport function _request<T extends ServiceObject>(serviceObject: T) {\r\n    return (reqOpts: DecorateRequestOptions, callback?: BodyResponseCallback) => {\r\n        if (!callback)\r\n            return serviceObject.request(reqOpts);\r\n        return serviceObject.request(reqOpts, callback);\r\n    }\r\n}\r\n\r\nexport function _delete<T extends ServiceObject>(serviceObject: T): (options?: DeleteOptions) => Promise<[r.Response]>;\r\nexport function _delete<T extends ServiceObject>(serviceObject: T): (options: DeleteOptions, callback: DeleteCallback) => void;\r\nexport function _delete<T extends ServiceObject>(serviceObject: T): (callback: DeleteCallback) => void;\r\nexport function _delete<T extends ServiceObject>(serviceObject: T) {\r\n    return (options: DeleteOptions, callback?: DeleteCallback) => {\r\n        if (!callback)\r\n            return serviceObject.delete(callback)\r\n        return serviceObject.delete(options, callback)\r\n    }\r\n}\r\n\r\nexport function _exists<T extends ServiceObject>(serviceObject: T): (options?: ExistsOptions) => Promise<[boolean]>;\r\nexport function _exists<T extends ServiceObject>(serviceObject: T): (options: ExistsOptions, callback: ExistsCallback) => void;\r\nexport function _exists<T extends ServiceObject>(serviceObject: T): (callback: ExistsCallback) => void;\r\nexport function _exists<T extends ServiceObject>(serviceObject: T) {\r\n    return (options: ExistsOptions, callback?: ExistsCallback) => {\r\n        if (!callback)\r\n            return serviceObject.exists(options)\r\n        return serviceObject.exists(options, callback)\r\n    }\r\n}\r\n\r\ndeclare type GetOrCreateOptions = GetConfig & CreateOptions;\r\nexport function _get<T extends ServiceObject>(serviceObject: T): (options?: GetOrCreateOptions) => Promise<GetResponse<T>>;\r\nexport function _get<T extends ServiceObject>(serviceObject: T): (callback: InstanceResponseCallback<T>) => void;\r\nexport function _get<T extends ServiceObject>(serviceObject: T): (options: GetOrCreateOptions, callback: InstanceResponseCallback<T>) => void;\r\nexport function _get<T extends ServiceObject>(serviceObject: T) {\r\n    return (options: GetOrCreateOptions, callback?: InstanceResponseCallback<T>) => {\r\n        if (!callback)\r\n            return serviceObject.get(options)\r\n        return serviceObject.get(options, callback)\r\n    }\r\n}\r\n\r\nexport function _getMetadata<T extends ServiceObject>(serviceObject: T): (options?: GetMetadataOptions) => Promise<MetadataResponse>;\r\nexport function _getMetadata<T extends ServiceObject>(serviceObject: T): (options: GetMetadataOptions, callback: MetadataCallback) => void;\r\nexport function _getMetadata<T extends ServiceObject>(serviceObject: T): (callback: MetadataCallback) => void;\r\nexport function _getMetadata<T extends ServiceObject>(serviceObject: T) {\r\n    return (options: GetMetadataOptions, callback?: MetadataCallback) => {\r\n        if (!callback)\r\n            return serviceObject.getMetadata(options);\r\n        return serviceObject.getMetadata(options, callback);\r\n    }\r\n}\r\n\r\nexport function _setMetadata<T extends ServiceObject>(serviceObject: T): (metadata: Metadata, options?: Metadata) => Promise<[Metadata]>;\r\nexport function _setMetadata<T extends ServiceObject>(serviceObject: T): (metadata: Metadata, callback: MetadataCallback) => void;\r\nexport function _setMetadata<T extends ServiceObject>(serviceObject: T): (metadata: Metadata, options: Metadata, callback: MetadataCallback) => void;\r\nexport function _setMetadata<T extends ServiceObject>(serviceObject: T) {\r\n    return (metadata: Metadata, options?: Metadata, callback?: MetadataCallback) => {\r\n        if (!options)\r\n            return serviceObject.setMetadata(metadata)\r\n        if (!callback)\r\n            return serviceObject.setMetadata(metadata, options)\r\n        return serviceObject.setMetadata(metadata, options, callback)\r\n    }\r\n}\r\n\r\nexport const _metadata = <T extends ServiceObject>(serviceObject: T)=>serviceObject.metadata;\r\nexport const _baseUrl = <T extends ServiceObject>(serviceObject: T)=>serviceObject.baseUrl;\r\nexport const _parent = <T extends ServiceObject>(serviceObject: T)=>serviceObject.parent;\r\nexport const _id = <T extends ServiceObject>(serviceObject: T)=>serviceObject.id;\r\nexport const _requestStream = <T extends ServiceObject>(serviceObject: T) => (reqOpts: DecorateRequestOptions) => serviceObject.requestStream(reqOpts)\r\n\r\nexport const _addListener = <T extends ServiceObject>(serviceObject: T) => (event: string | symbol, listener: (...args: any[]) => void) => serviceObject.addListener(event, listener)\r\nexport const _on = <T extends ServiceObject>(serviceObject: T) => (event: string | symbol, listener: (...args: any[]) => void) => serviceObject.on(event, listener)\r\nexport const _once = <T extends ServiceObject>(serviceObject: T) => (event: string | symbol, listener: (...args: any[]) => void) => serviceObject.once(event, listener)\r\nexport const _prependListener = <T extends ServiceObject>(serviceObject: T) => (event: string | symbol, listener: (...args: any[]) => void) => serviceObject.prependListener(event, listener)\r\nexport const _prependOnceListener = <T extends ServiceObject>(serviceObject: T) => (event: string | symbol, listener: (...args: any[]) => void) => serviceObject.prependOnceListener(event, listener)\r\nexport const _removeListener = <T extends ServiceObject>(serviceObject: T) => (event: string | symbol, listener: (...args: any[]) => void) => serviceObject.removeListener(event, listener)\r\nexport const _off = <T extends ServiceObject>(serviceObject: T) => (event: string | symbol, listener: (...args: any[]) => void) => serviceObject.off(event, listener)\r\nexport const _removeAllListeners = <T extends ServiceObject>(serviceObject: T) => (event?: string | symbol) => serviceObject.removeAllListeners(event)\r\nexport const _setMaxListeners = <T extends ServiceObject>(serviceObject: T) => (n: number) => serviceObject.setMaxListeners(n)\r\nexport const _getMaxListeners = <T extends ServiceObject>(serviceObject: T) => () => serviceObject.getMaxListeners()\r\nexport const _listeners = <T extends ServiceObject>(serviceObject: T) => (event: string | symbol) => serviceObject.listeners(event)\r\nexport const _rawListeners = <T extends ServiceObject>(serviceObject: T) => (event: string | symbol) => serviceObject.rawListeners(event)\r\nexport const _emit = <T extends ServiceObject>(serviceObject: T) => (event: string | symbol, ...args: any[]) => serviceObject.emit(event, ...args)\r\nexport const _eventNames = <T extends ServiceObject>(serviceObject: T) => () => serviceObject.eventNames()\r\nexport const _listenerCount = <T extends ServiceObject>(serviceObject: T) => (type: string | symbol) => serviceObject.listenerCount(type)\r\n","import {\r\n    File, CreateReadStreamOptions, CreateWriteStreamOptions, CopyOptions, CopyResponse, CopyCallback, CreateResumableUploadOptions, CreateResumableUploadResponse\r\n    , CreateResumableUploadCallback, DownloadOptions, DownloadResponse, DownloadCallback, GetExpirationDateCallback, GetExpirationDateResponse,\r\n    GetSignedPolicyOptions, GetSignedPolicyResponse, GetSignedPolicyCallback, GetSignedUrlConfig, GetSignedUrlResponse, GetSignedUrlCallback, Bucket\r\n} from 'firebase-admin/node_modules/@google-cloud/storage';\r\nimport {\r\n    IsPublicResponse,\r\n    IsPublicCallback,\r\n    MakeFilePrivateOptions,\r\n    MakeFilePrivateResponse,\r\n    MakeFilePrivateCallback,\r\n    MakeFilePublicResponse,\r\n    MakeFilePublicCallback,\r\n    MoveOptions,\r\n    MoveResponse,\r\n    MoveCallback, RotateEncryptionKeyOptions,\r\n    RotateEncryptionKeyResponse,\r\n    RotateEncryptionKeyCallback, SaveOptions,\r\n    SaveCallback,\r\n    SetStorageClassCallback,\r\n    SetStorageClassResponse,\r\n    SetStorageClassOptions,\r\n} from 'firebase-admin/node_modules/@google-cloud/storage/build/src/file';\r\n\r\nimport { Duplexify } from '@google-cloud/common/build/src/util';\r\nimport * as serviceObject from './service-object'\r\nexport interface MappedFile extends Omit<File, 'name' | 'getSignedUrlV2' | 'getSignedUrlV4' | 'getCanonicalHeaders' | 'interceptors' | 'methods' | 'request_'> {\r\n    // Omits some private properties\r\n}\r\n\r\ntype ofFile<X extends keyof File> = (file: File) => File[X];\r\nexport const createWriteStream = (file: File) => (options?: CreateWriteStreamOptions) => {\r\n    if(!options)\r\n        return file.createWriteStream()\r\n    return file.createWriteStream(options)\r\n}\r\n\r\nexport const createReadStream: ofFile<'createReadStream'> = (file) => (options?: CreateReadStreamOptions) => file.createReadStream(options);\r\nexport default createReadStream;\r\n\r\nexport const request: ofFile<'request'> = serviceObject._request;\r\nconst remove: ofFile<'delete'> = serviceObject._delete;\r\nexport {remove as delete}\r\nexport const create: ofFile<'create'> = serviceObject._create; \r\nexport const exists: ofFile<'exists'> = serviceObject._exists; \r\nexport const get: ofFile<'get'> = serviceObject._get;\r\nexport const getMetadata: ofFile<'getMetadata'> = serviceObject._getMetadata; \r\nexport const setMetadata: ofFile<'setMetadata'> = serviceObject._setMetadata;\r\nexport const metadata: ofFile<'metadata'> = serviceObject._metadata\r\nexport const baseUrl: ofFile<'baseUrl'> = serviceObject._baseUrl\r\nexport const id: ofFile<'id'> = serviceObject._id\r\nexport const requestStream: ofFile<'requestStream'> = serviceObject._requestStream\r\nexport const addListener: ofFile<'addListener'> = serviceObject._addListener\r\nexport const on: ofFile<'on'> = serviceObject._on\r\nexport const once: ofFile<'once'> = serviceObject._once\r\nexport const prependListener: ofFile<'prependListener'> = serviceObject._prependListener\r\nexport const prependOnceListener: ofFile<'prependOnceListener'> = serviceObject._prependOnceListener\r\nexport const removeListener: ofFile<'removeListener'> = serviceObject._removeListener\r\nexport const off: ofFile<'off'> = serviceObject._off\r\nexport const removeAllListeners: ofFile<'removeAllListeners'> = serviceObject._removeAllListeners\r\nexport const setMaxListeners: ofFile<'setMaxListeners'> = serviceObject._setMaxListeners\r\nexport const getMaxListeners: ofFile<'getMaxListeners'> = serviceObject._getMaxListeners\r\nexport const listeners: ofFile<'listeners'> = serviceObject._listeners\r\nexport const rawListeners: ofFile<'rawListeners'> = serviceObject._rawListeners\r\nexport const emit: ofFile<'emit'> = serviceObject._emit\r\nexport const eventNames: ofFile<'eventNames'> = serviceObject._eventNames\r\nexport const listenerCount: ofFile<'listenerCount'> = serviceObject._listenerCount\r\nexport const parent: ofFile<'parent'> = (serviceObject: File)=>serviceObject.parent\r\n\r\n\r\nfunction _copy<DESTINATION extends string | Bucket | File, OPTIONS extends CopyOptions>(file: File): (destination: DESTINATION, options?: OPTIONS) => Promise<CopyResponse>;\r\nfunction _copy<DESTINATION extends string | Bucket | File, CALLBACK extends CopyCallback>(file: File): (destination: DESTINATION, callback: CALLBACK) => void;\r\nfunction _copy<DESTINATION extends string | Bucket | File>(file: File): (destination: DESTINATION, options: CopyOptions, callback: CopyCallback) => void;\r\nfunction _copy(file: File) {\r\n    return (destination: string, options?: CopyOptions, callback?: CopyCallback) => {\r\n        if (!options)\r\n            return file.copy(destination)\r\n        if (!callback)\r\n            return file.copy(destination, options)\r\n        return file.copy(destination, options, callback)\r\n    }\r\n}\r\nexport const copy: ofFile<'copy'> = _copy;\r\n\r\nfunction _createResumableUpload<OPTIONS extends CreateResumableUploadOptions>(file: File): (options?: OPTIONS) => Promise<CreateResumableUploadResponse>;\r\nfunction _createResumableUpload<CALLBACK extends CreateResumableUploadCallback>(file: File): (callback: CALLBACK) => void;\r\nfunction _createResumableUpload(file: File): (options: CreateResumableUploadOptions, callback: CreateResumableUploadCallback) => void;\r\nfunction _createResumableUpload(file: File) {\r\n    return (options?: CreateResumableUploadOptions, callback?: CreateResumableUploadCallback) => {\r\n        if (!options)\r\n            return file.createResumableUpload()\r\n        if (!callback)\r\n            return file.createResumableUpload(options)\r\n        return file.createResumableUpload(options, callback)\r\n    }\r\n}\r\nexport const createResumableUpload: ofFile<'createResumableUpload'> = _createResumableUpload;\r\n\r\nexport const deleteResumableCache: ofFile<'deleteResumableCache'> = (file) => () => file.deleteResumableCache();\r\n\r\nfunction _download<OPTIONS extends DownloadOptions>(file: File): (options?: OPTIONS) => Promise<DownloadResponse>;\r\nfunction _download<CALLBACK extends DownloadCallback>(file: File): (callback: CALLBACK) => void;\r\nfunction _download(file: File): (options: DownloadOptions, callback: DownloadCallback) => void;\r\nfunction _download(file: File) {\r\n    return (options?: DownloadOptions, callback?: DownloadCallback) => {\r\n        if (!options)\r\n            return file.download()\r\n        if (!callback)\r\n            return file.download(options)\r\n        return file.download(options, callback)\r\n    }\r\n}\r\nexport const download: ofFile<'download'> = _download\r\n\r\nexport const setEncryptionKey: ofFile<'setEncryptionKey'> = (file) => (encryptionKey: string | Buffer) => {\r\n    if (typeof encryptionKey === 'string')\r\n        return file.setEncryptionKey(encryptionKey);\r\n    return file.setEncryptionKey(encryptionKey);\r\n}\r\n\r\nfunction _getExpirationDate(file: File): () => Promise<GetExpirationDateResponse>;\r\nfunction _getExpirationDate(file: File): (callback: GetExpirationDateCallback) => void;\r\nfunction _getExpirationDate(file: File) {\r\n    return (callback?: GetExpirationDateCallback) => {\r\n        if (!callback)\r\n            return file.getExpirationDate();\r\n        return file.getExpirationDate(callback);\r\n    }\r\n}\r\nexport const getExpirationDate: ofFile<'getExpirationDate'> = _getExpirationDate;\r\nfunction _getSignedPolicy<OPTIONS extends GetSignedPolicyOptions>(file: File): (options: OPTIONS) => Promise<GetSignedPolicyResponse>;\r\nfunction _getSignedPolicy(file: File): (options: GetSignedPolicyOptions, callback: GetSignedPolicyCallback) => void;\r\nfunction _getSignedPolicy<CALLBACK extends GetSignedPolicyCallback>(file: File): (callback: CALLBACK) => void;\r\nfunction _getSignedPolicy(file: File) {\r\n    return (options: GetSignedPolicyOptions, callback?: GetSignedPolicyCallback) => {\r\n        if (!callback)\r\n            return file.getSignedPolicy(options);\r\n        return file.getSignedPolicy(options, callback);\r\n    }\r\n}\r\nexport const getSignedPolicy: ofFile<'getSignedPolicy'> = _getSignedPolicy;\r\n\r\nfunction _getSignedUrl(file: File): (cfg: GetSignedUrlConfig) => Promise<GetSignedUrlResponse>;\r\nfunction _getSignedUrl(file: File): (cfg: GetSignedUrlConfig, callback: GetSignedUrlCallback) => void;\r\nfunction _getSignedUrl(file: File) {\r\n    return (cfg: GetSignedUrlConfig, callback?: GetSignedUrlCallback) => {\r\n        if (!callback)\r\n            return file.getSignedUrl(cfg);\r\n        return file.getSignedUrl(cfg, callback);\r\n    }\r\n}\r\nexport const getSignedUrl: ofFile<'getSignedUrl'> = _getSignedUrl;\r\n\r\nfunction _isPublic(file: File): () => Promise<IsPublicResponse>;\r\nfunction _isPublic(file: File): (callback: IsPublicCallback) => void;\r\nfunction _isPublic(file: File) {\r\n    return (callback?: IsPublicCallback) => {\r\n        if (!callback)\r\n            return file.isPublic();\r\n        return file.isPublic(callback);\r\n    }\r\n}\r\nexport const isPublic: ofFile<'isPublic'> = _isPublic;\r\n\r\nfunction _makePrivate<OPTIONS extends MakeFilePrivateOptions>(file: File): (options?: OPTIONS) => Promise<MakeFilePrivateResponse>;\r\nfunction _makePrivate<CALLBACK extends MakeFilePrivateCallback>(file: File): (callback: CALLBACK) => void;\r\nfunction _makePrivate(file: File): (options: MakeFilePrivateOptions, callback: MakeFilePrivateCallback) => void;\r\nfunction _makePrivate(file: File) {\r\n    return (options?: MakeFilePrivateOptions, callback?: MakeFilePrivateCallback) => {\r\n        if (!options)\r\n            return file.makePrivate();\r\n        if (!callback)\r\n            return file.makePrivate(options);\r\n        return file.makePrivate(options, callback);\r\n    }\r\n}\r\nexport const makePrivate: ofFile<'makePrivate'> = _makePrivate;\r\n\r\nfunction _makePublic(file: File): () => Promise<MakeFilePublicResponse>;\r\nfunction _makePublic(file: File): (callback: MakeFilePublicCallback) => void;\r\nfunction _makePublic(file: File) {\r\n    return (callback?: MakeFilePublicCallback) => {\r\n        if (!callback)\r\n            return file.makePublic();\r\n        return file.makePublic(callback);\r\n    }\r\n}\r\nexport const makePublic: ofFile<'makePublic'> = _makePublic;\r\n\r\nfunction _move<OPTIONS extends MoveOptions>(file: File): (destination: string | Bucket | File, options?: OPTIONS) => Promise<MoveResponse>;\r\nfunction _move<CALLBACK extends MoveCallback>(file: File): (destination: string | Bucket | File, callback: CALLBACK) => void;\r\nfunction _move(file: File): (destination: string | Bucket | File, options: MoveOptions, callback: MoveCallback) => void;\r\nfunction _move(file: File) {\r\n    return (destination: string | Bucket | File, options?: MoveOptions, callback?: MoveCallback) => {\r\n        if (!options)\r\n            return file.move(destination);\r\n        if (!callback)\r\n            return file.move(destination, options);\r\n        return file.move(destination, options, callback);\r\n    }\r\n}\r\nexport const move: ofFile<'move'> = _move;\r\n\r\nfunction _rotateEncryptionKey<CALLBACK extends RotateEncryptionKeyCallback>(file: File): (callback: CALLBACK) => void;\r\nfunction _rotateEncryptionKey<OPTIONS extends RotateEncryptionKeyOptions>(file: File): (options?: OPTIONS) => Promise<RotateEncryptionKeyResponse>;\r\nfunction _rotateEncryptionKey(file: File): (options: RotateEncryptionKeyOptions, callback: RotateEncryptionKeyCallback) => void;\r\nfunction _rotateEncryptionKey(file: File) {\r\n    return (options?: RotateEncryptionKeyOptions, callback?: RotateEncryptionKeyCallback) => {\r\n        if (!options)\r\n            return file.rotateEncryptionKey();\r\n        if (!callback)\r\n            return file.rotateEncryptionKey(options);\r\n        return file.rotateEncryptionKey(options, callback);\r\n    }\r\n}\r\nexport const rotateEncryptionKey: ofFile<'rotateEncryptionKey'> = _rotateEncryptionKey;\r\n\r\nfunction _save<OPTIONS extends SaveOptions>(file: File): (data: any, options?: OPTIONS) => Promise<void>;\r\nfunction _save<CALLBACK extends SaveCallback>(file: File): (data: any, callback: CALLBACK) => void;\r\nfunction _save(file: File): (data: any, options: SaveOptions, callback: SaveCallback) => void;\r\nfunction _save(file: File) {\r\n    return (data: any, options?: SaveOptions, callback?: SaveCallback) => {\r\n        if (!options)\r\n            return file.save(data);\r\n        if (!callback)\r\n            return file.save(data, options);\r\n        return file.save(data, options, callback);\r\n    }\r\n}\r\nexport const save: ofFile<'save'> = _save;\r\n\r\nfunction _setStorageClass(file: File): (storageClass: string, options?: SetStorageClassOptions | SetStorageClassCallback) => Promise<SetStorageClassResponse>;\r\nfunction _setStorageClass(file: File): (storageClass: string, options: SetStorageClassOptions, callback: SetStorageClassCallback) => void;\r\nfunction _setStorageClass<CALLBACK extends SaveCallback>(file: File): (storageClass: string, callback?: CALLBACK) => void;\r\nfunction _setStorageClass(file: File) {\r\n    return (storageClass: string, options?: SetStorageClassOptions, callback?: SetStorageClassCallback) => {\r\n        if (!options)\r\n            return file.setStorageClass(storageClass);\r\n        if (!callback)\r\n            return file.setStorageClass(storageClass, options);\r\n        return file.setStorageClass(storageClass, options, callback);\r\n    }\r\n}\r\nexport const setStorageClass: ofFile<'setStorageClass'> = _setStorageClass;\r\n\r\nexport const setUserProject: ofFile<'setUserProject'> = (file) => (userProject: string) => file.setUserProject(userProject);\r\nexport const startResumableUpload_: ofFile<'startResumableUpload_'> = (file) => (dup: Duplexify, options: CreateResumableUploadOptions) => file.startResumableUpload_(dup, options);\r\nexport const startSimpleUpload_: ofFile<'startSimpleUpload_'> = (file) => (dup: Duplexify, options: CreateResumableUploadOptions) => file.startSimpleUpload_(dup, options);\r\n\r\n\r\n\r\nexport const acl: ofFile<'acl'> = (file) => file.acl\r\nexport const bucket: ofFile<'bucket'> = (file) => file.bucket\r\nexport const storage: ofFile<'storage'> = (file) => file.storage\r\nexport const kmsKeyName: ofFile<'kmsKeyName'> = (file) => file.kmsKeyName\r\nexport const userProject: ofFile<'userProject'> = (file) => file.userProject\r\nexport const name: ofFile<'name'> = (file) => file.name\r\nexport const generation: ofFile<'generation'> = (file) => file.generation\r\n","import {\r\n    Bucket, FileOptions, UploadOptions,\r\n    File,\r\n    CombineOptions,\r\n    CombineResponse,\r\n    CombineCallback,\r\n    CreateChannelConfig,\r\n    CreateChannelOptions,\r\n    CreateChannelResponse,\r\n    CreateChannelCallback,\r\n    CreateNotificationOptions,\r\n    CreateNotificationResponse,\r\n    CreateNotificationCallback,\r\n    DeleteFilesOptions,\r\n    DeleteFilesCallback,\r\n    DeleteLabelsResponse,\r\n    DeleteLabelsCallback,\r\n    DisableRequesterPaysResponse,\r\n    DisableRequesterPaysCallback,\r\n    EnableRequesterPaysResponse,\r\n    EnableRequesterPaysCallback,\r\n} from 'firebase-admin/node_modules/@google-cloud/storage';\r\n\r\nimport {\r\n    LifecycleRule,\r\n    AddLifecycleRuleOptions,\r\n    SetBucketMetadataResponse,\r\n    SetBucketMetadataCallback,\r\n    EnableLoggingOptions,\r\n    GetFilesOptions,\r\n    GetFilesResponse,\r\n    MakeBucketPrivateCallback,\r\n    MakeBucketPrivateOptions,\r\n    MakeBucketPublicOptions,\r\n    GetFilesCallback,\r\n    GetLabelsCallback,\r\n    GetNotificationsOptions,\r\n    GetNotificationsResponse,\r\n    GetNotificationsCallback,\r\n    BucketLockResponse,\r\n    BucketLockCallback,\r\n    MakeBucketPrivateResponse,\r\n    MakeBucketPublicResponse,\r\n    MakeBucketPublicCallback,\r\n    GetLabelsOptions,\r\n    GetLabelsResponse,\r\n    SetLabelsOptions,\r\n    SetLabelsResponse,\r\n    SetLabelsCallback,\r\n    SetBucketStorageClassOptions,\r\n    SetBucketStorageClassCallback,\r\n    Labels,\r\n    UploadResponse,\r\n    UploadCallback,\r\n    MakeAllFilesPublicPrivateOptions,\r\n\r\n} from 'firebase-admin/node_modules/@google-cloud/storage/build/src/bucket';\r\nimport * as serviceObject from './service-object'\r\nexport interface MappedBucket extends Omit<Bucket, 'name' | 'createMethod' | 'interceptors' | 'methods' | 'request_'> {\r\n    \r\n}\r\n\r\ntype ofBucket<X extends keyof Bucket> = (bucket: Bucket) => Bucket[X];\r\n\r\nexport const file: ofBucket<'file'> = (bucket) => (name: string, options?: FileOptions) => {\r\n    if(!options)\r\n        return bucket.file(name)\r\n    return bucket.file(name, options)\r\n}\r\nexport default file;\r\n\r\nexport const request: ofBucket<'request'> = serviceObject._request;\r\nconst remove: ofBucket<'delete'> = serviceObject._delete;\r\nexport {remove as delete}\r\nexport const create: ofBucket<'create'> = serviceObject._create; \r\nexport const exists: ofBucket<'exists'> = serviceObject._exists; \r\nexport const get: ofBucket<'get'> = serviceObject._get;\r\nexport const getMetadata: ofBucket<'getMetadata'> = serviceObject._getMetadata; \r\nexport const setMetadata: ofBucket<'setMetadata'> = serviceObject._setMetadata;\r\nexport const metadata: ofBucket<'metadata'> = serviceObject._metadata\r\nexport const baseUrl: ofBucket<'baseUrl'> = serviceObject._baseUrl\r\nexport const parent: ofBucket<'parent'> = serviceObject._parent\r\nexport const id: ofBucket<'id'> = serviceObject._id\r\nexport const requestStream: ofBucket<'requestStream'> = serviceObject._requestStream\r\nexport const addListener: ofBucket<'addListener'> = serviceObject._addListener\r\nexport const on: ofBucket<'on'> = serviceObject._on\r\nexport const once: ofBucket<'once'> = serviceObject._once\r\nexport const prependListener: ofBucket<'prependListener'> = serviceObject._prependListener\r\nexport const prependOnceListener: ofBucket<'prependOnceListener'> = serviceObject._prependOnceListener\r\nexport const removeListener: ofBucket<'removeListener'> = serviceObject._removeListener\r\nexport const off: ofBucket<'off'> = serviceObject._off\r\nexport const removeAllListeners: ofBucket<'removeAllListeners'> = serviceObject._removeAllListeners\r\nexport const setMaxListeners: ofBucket<'setMaxListeners'> = serviceObject._setMaxListeners\r\nexport const getMaxListeners: ofBucket<'getMaxListeners'> = serviceObject._getMaxListeners\r\nexport const listeners: ofBucket<'listeners'> = serviceObject._listeners\r\nexport const rawListeners: ofBucket<'rawListeners'> = serviceObject._rawListeners\r\nexport const emit: ofBucket<'emit'> = serviceObject._emit\r\nexport const eventNames: ofBucket<'eventNames'> = serviceObject._eventNames\r\nexport const listenerCount: ofBucket<'listenerCount'> = serviceObject._listenerCount\r\n\r\nexport const name:ofBucket<'name'> = (bucket)=>bucket.name;\r\nexport const storage:ofBucket<'storage'> = (bucket)=>bucket.storage;\r\nexport const userProject:ofBucket<'userProject'> = (bucket)=>bucket.userProject;\r\nexport const acl:ofBucket<'acl'> = (bucket)=>bucket.acl;\r\nexport const iam:ofBucket<'iam'> = (bucket)=>bucket.iam;\r\nexport const getFilesStream:ofBucket<'getFilesStream'> = (bucket)=>bucket.getFilesStream;\r\n\r\nfunction _addLifecycleRule<OPTIONS extends AddLifecycleRuleOptions>(bucket: Bucket): (rule: LifecycleRule, options?: OPTIONS) => Promise<SetBucketMetadataResponse>;\r\nfunction _addLifecycleRule(bucket: Bucket): (rule: LifecycleRule, options: AddLifecycleRuleOptions, callback: SetBucketMetadataCallback) => void;\r\nfunction _addLifecycleRule<CALLBACK extends SetBucketMetadataCallback>(bucket: Bucket): (rule: LifecycleRule, callback: CALLBACK) => void;\r\nfunction _addLifecycleRule<OPTIONS>(bucket: Bucket) {\r\n    return (rule: LifecycleRule, options?: OPTIONS, callback?: SetBucketMetadataCallback) => {\r\n        if (!options)\r\n            return bucket.addLifecycleRule(rule)\r\n        if (!callback)\r\n            return bucket.addLifecycleRule(rule, options)\r\n        return bucket.addLifecycleRule(rule, options, callback)\r\n    }\r\n}\r\nexport const addLifecycleRule: ofBucket<'addLifecycleRule'> = _addLifecycleRule;\r\nfunction _combine<OPTIONS extends CombineOptions>(bucket: Bucket): (sources: string[] | File[], destination: string | File, options?: OPTIONS) => Promise<CombineResponse>;\r\nfunction _combine(bucket: Bucket): (sources: string[] | File[], destination: string | File, options: CombineOptions, callback: CombineCallback) => void;\r\nfunction _combine<CALLBACK extends CombineCallback>(bucket: Bucket): (sources: string[] | File[], destination: string | File, callback: CALLBACK) => void;\r\nfunction _combine<OPTIONS>(bucket: Bucket) {\r\n    return (sources: string[] | File[], destination: string | File, options?: OPTIONS, callback?: CombineCallback) => {\r\n        if (!options)\r\n            return bucket.combine(sources, destination)\r\n        if (!callback)\r\n            return bucket.combine(sources, destination, options)\r\n        return bucket.combine(sources, destination, options, callback)\r\n    }\r\n}\r\nexport const combine: ofBucket<'combine'> = _combine;\r\nfunction _createChannel<OPTIONS extends CreateChannelOptions>(bucket: Bucket): (id: string, config: CreateChannelConfig, options?: OPTIONS) => Promise<CreateChannelResponse>;\r\nfunction _createChannel<CALLBACK extends CreateChannelCallback>(bucket: Bucket): (id: string, config: CreateChannelConfig, callback: CALLBACK) => void;\r\nfunction _createChannel(bucket: Bucket): (id: string, config: CreateChannelConfig, options: CreateChannelOptions, callback: CreateChannelCallback) => void;\r\nfunction _createChannel(bucket: Bucket) {\r\n    return (id: string, config: CreateChannelConfig, options: CreateChannelOptions, callback?: CreateChannelCallback) => {\r\n        if (!options)\r\n            return bucket.createChannel(id, config)\r\n        if (!callback)\r\n            return bucket.createChannel(id, config, options)\r\n        return bucket.createChannel(id, config, options, callback)\r\n    }\r\n}\r\nexport const createChannel: ofBucket<'createChannel'> = _createChannel;\r\nfunction _createNotification<OPTIONS extends CreateNotificationOptions>(bucket: Bucket): (topic: string, options?: OPTIONS) => Promise<CreateNotificationResponse>;\r\nfunction _createNotification(bucket: Bucket): (topic: string, options: CreateNotificationOptions, callback: CreateNotificationCallback) => void;\r\nfunction _createNotification<CALLBACK extends CreateNotificationCallback>(bucket: Bucket): (topic: string, callback: CALLBACK) => void;\r\nfunction _createNotification(bucket: Bucket) {\r\n    return (topic: string, options: CreateNotificationOptions, callback: CreateNotificationCallback) => {\r\n        if (!options)\r\n            return bucket.createNotification(topic)\r\n        if (!callback)\r\n            return bucket.createNotification(topic, options)\r\n        return bucket.createNotification(topic, options, callback)\r\n    }\r\n}\r\nexport const createNotification: ofBucket<'createNotification'> = _createNotification;\r\n\r\nfunction _deleteFiles<OPTIONS extends DeleteFilesOptions>(bucket: Bucket): (query?: OPTIONS) => Promise<void>;\r\nfunction _deleteFiles<CALLBACK extends DeleteFilesCallback>(bucket: Bucket): (callback: CALLBACK) => void;\r\nfunction _deleteFiles(bucket: Bucket): (query: DeleteFilesOptions, callback: DeleteFilesCallback) => void;\r\nfunction _deleteFiles(bucket: Bucket) {\r\n    return (query: DeleteFilesOptions, callback?: DeleteFilesCallback) => {\r\n        if (!callback)\r\n            return bucket.deleteFiles(query)\r\n        return bucket.deleteFiles(query, callback)\r\n    }\r\n}\r\nexport const deleteFiles: ofBucket<'deleteFiles'> = _deleteFiles;\r\nfunction _deleteLabels<LABELS extends string | string[]>(bucket: Bucket): (labels?: LABELS) => Promise<DeleteLabelsResponse>;\r\nfunction _deleteLabels<CALLBACK extends DeleteLabelsCallback>(bucket: Bucket): (callback: CALLBACK) => void;\r\nfunction _deleteLabels(bucket: Bucket): (labels: string | string[], callback: DeleteLabelsCallback) => void;\r\nfunction _deleteLabels(bucket: Bucket) {\r\n    return (labels: string | string[], callback: DeleteLabelsCallback) => {\r\n        if (!callback)\r\n            return bucket.deleteLabels(labels)\r\n        return bucket.deleteLabels(labels, callback)\r\n    }\r\n}\r\nexport const deleteLabels: ofBucket<'deleteLabels'> = _deleteLabels;\r\nfunction _disableRequesterPays(bucket: Bucket): () => Promise<DisableRequesterPaysResponse>;\r\nfunction _disableRequesterPays<CALLBACK extends DisableRequesterPaysCallback>(bucket: Bucket): (callback: CALLBACK) => void;\r\nfunction _disableRequesterPays(bucket: Bucket) {\r\n    return (callback?: DisableRequesterPaysCallback) => {\r\n        if (!callback)\r\n            return bucket.disableRequesterPays()\r\n        return bucket.disableRequesterPays(callback)\r\n    }\r\n}\r\nexport const disableRequesterPays: ofBucket<'disableRequesterPays'> = _disableRequesterPays;\r\nfunction _enableLogging(bucket: Bucket): (config: EnableLoggingOptions) => Promise<SetBucketMetadataResponse>;\r\nfunction _enableLogging(bucket: Bucket): (config: EnableLoggingOptions, callback: SetBucketMetadataCallback) => void;\r\nfunction _enableLogging(bucket: Bucket) {\r\n    return (config: EnableLoggingOptions, callback: SetBucketMetadataCallback) => {\r\n        if (!callback)\r\n            return bucket.enableLogging(config)\r\n        return bucket.enableLogging(config, callback)\r\n    }\r\n}\r\nexport const enableLogging: ofBucket<'enableLogging'> = _enableLogging;\r\nfunction _enableRequesterPays(bucket: Bucket): () => Promise<EnableRequesterPaysResponse>;\r\nfunction _enableRequesterPays(bucket: Bucket): (callback: EnableRequesterPaysCallback) => void;\r\nfunction _enableRequesterPays(bucket: Bucket) {\r\n    return (callback?: EnableRequesterPaysCallback) => {\r\n        if (!callback)\r\n            return bucket.enableRequesterPays()\r\n        return bucket.enableRequesterPays(callback)\r\n    }\r\n}\r\nexport const enableRequesterPays: ofBucket<'enableRequesterPays'> = _enableRequesterPays;\r\n\r\nfunction _getFiles<OPTIONS extends GetFilesOptions>(bucket: Bucket): (query?: OPTIONS) => Promise<GetFilesResponse>;\r\nfunction _getFiles(bucket: Bucket): (query: GetFilesOptions, callback: GetFilesCallback) => void;\r\nfunction _getFiles<CALLBACK extends GetFilesCallback>(bucket: Bucket): (callback: CALLBACK) => void;\r\nfunction _getFiles(bucket: Bucket) {\r\n    return (query: GetFilesOptions, callback: GetFilesCallback) => {\r\n        if (!callback)\r\n            return bucket.getFiles(query)\r\n        return bucket.getFiles(query, callback)\r\n    }\r\n}\r\nexport const getFiles: ofBucket<'getFiles'> = _getFiles;\r\nfunction _getLabels<OPTIONS extends GetLabelsOptions>(bucket: Bucket): (options: OPTIONS) => Promise<GetLabelsResponse>;\r\nfunction _getLabels<CALLBACK extends GetLabelsCallback>(bucket: Bucket): (callback: CALLBACK) => void;\r\nfunction _getLabels(bucket: Bucket): (options: GetLabelsOptions, callback: GetLabelsCallback) => void;\r\nfunction _getLabels(bucket: Bucket) {\r\n    return (options: GetLabelsOptions, callback?: GetLabelsCallback) => {\r\n        if (!callback)\r\n            return bucket.getLabels(options)\r\n        bucket.getLabels(options, callback);\r\n    }\r\n}\r\nexport const getLabels: ofBucket<'getLabels'> = _getLabels;\r\n\r\nfunction _getNotifications<OPTIONS extends GetNotificationsOptions>(bucket: Bucket): (options?: OPTIONS) => Promise<GetNotificationsResponse>;\r\nfunction _getNotifications<CALLBACK extends GetNotificationsCallback>(bucket: Bucket): (callback: CALLBACK) => void;\r\nfunction _getNotifications(bucket: Bucket): (options: GetNotificationsOptions, callback: GetNotificationsCallback) => void;\r\nfunction _getNotifications(bucket: Bucket) {\r\n    return (options?: GetNotificationsOptions, callback?: GetNotificationsCallback) => {\r\n        if (!options)\r\n            return bucket.getNotifications()\r\n        if (!callback)\r\n            return bucket.getNotifications(options)\r\n        bucket.getNotifications(options, callback);\r\n    }\r\n}\r\nexport const getNotifications: ofBucket<'getNotifications'> = _getNotifications;\r\n\r\nfunction _lock(bucket: Bucket): (metageneration: number | string) => Promise<BucketLockResponse>;\r\nfunction _lock(bucket: Bucket): (metageneration: number | string, callback: BucketLockCallback) => void;\r\nfunction _lock(bucket: Bucket) {\r\n    return (metageneration: number | string, callback?: BucketLockCallback) => {\r\n        if (!callback)\r\n            return bucket.lock(metageneration)\r\n        bucket.lock(metageneration, callback);\r\n    }\r\n}\r\nexport const lock: ofBucket<'lock'> = _lock;\r\nfunction _makePrivate<OPTIONS extends MakeBucketPrivateOptions>(bucket: Bucket): (options?: OPTIONS) => Promise<MakeBucketPrivateResponse>;\r\nfunction _makePrivate<CALLBACK extends MakeBucketPrivateCallback>(bucket: Bucket): (callback: CALLBACK) => void;\r\nfunction _makePrivate(bucket: Bucket): (options: MakeBucketPrivateOptions, callback: MakeBucketPrivateCallback) => void;\r\nfunction _makePrivate(bucket: Bucket) {\r\n    return (options: MakeBucketPrivateOptions, callback?: MakeBucketPrivateCallback) => {\r\n        if (!options)\r\n            return bucket.makePrivate()\r\n        if (!callback)\r\n            return bucket.makePrivate(options)\r\n        bucket.makePrivate(options, callback);\r\n    }\r\n}\r\nexport const makePrivate: ofBucket<'makePrivate'> = _makePrivate;\r\nfunction _makePublic<OPTIONS extends MakeBucketPublicOptions>(bucket: Bucket): (options?: OPTIONS) => Promise<MakeBucketPublicResponse>;\r\nfunction _makePublic<CALLBACK extends MakeBucketPublicCallback>(bucket: Bucket): (callback: CALLBACK) => void;\r\nfunction _makePublic(bucket: Bucket): (options: MakeBucketPublicOptions, callback: MakeBucketPublicCallback) => void;\r\nfunction _makePublic(bucket: Bucket) {\r\n    return (options: MakeBucketPublicOptions, callback?: MakeBucketPublicCallback) => {\r\n        if (!options)\r\n            return bucket.makePublic()\r\n        if (!callback)\r\n            return bucket.makePublic(options)\r\n        bucket.makePublic(options, callback);\r\n    }\r\n}\r\nexport const makePublic: ofBucket<'makePublic'> = _makePublic;\r\n\r\nexport const notification: ofBucket<'notification'> = (bucket) => (id: string) => bucket.notification(id);\r\nfunction _removeRetentionPeriod(bucket: Bucket): () => Promise<SetBucketMetadataResponse>;\r\nfunction _removeRetentionPeriod(bucket: Bucket): (callback: SetBucketMetadataCallback) => void;\r\nfunction _removeRetentionPeriod(bucket: Bucket) {\r\n    return (callback: SetBucketMetadataCallback) => {\r\n        if (!callback)\r\n            return bucket.removeRetentionPeriod();\r\n        return bucket.removeRetentionPeriod(callback);\r\n    }\r\n}\r\nexport const removeRetentionPeriod: ofBucket<'removeRetentionPeriod'> = _removeRetentionPeriod;\r\n\r\n\r\nfunction _setLabels<OPTIONS extends SetLabelsOptions>(bucket: Bucket): (labels: Labels, options?: OPTIONS) => Promise<SetLabelsResponse>;\r\nfunction _setLabels<CALLBACK extends SetLabelsCallback>(bucket: Bucket): (labels: Labels, callback: CALLBACK) => void;\r\nfunction _setLabels(bucket: Bucket): (labels: Labels, options: SetLabelsOptions, callback: SetLabelsCallback) => void;\r\nfunction _setLabels(bucket: Bucket) {\r\n    return (labels: Labels, options?: SetLabelsOptions, callback?: SetLabelsCallback) => {\r\n        if (!options)\r\n            return bucket.setLabels(labels);\r\n        if (!callback)\r\n            return bucket.setLabels(labels, options);\r\n        return bucket.setLabels(labels, options, callback);\r\n    }\r\n}\r\nexport const setLabels: ofBucket<'setLabels'> = _setLabels;\r\nfunction _setRetentionPeriod(bucket: Bucket): (duration: number) => Promise<SetBucketMetadataResponse>;\r\nfunction _setRetentionPeriod(bucket: Bucket): (duration: number, callback: SetBucketMetadataCallback) => void;\r\nfunction _setRetentionPeriod(bucket: Bucket) {\r\n    return (duration: number, callback?: SetBucketMetadataCallback) => {\r\n        if (!callback)\r\n            return bucket.setRetentionPeriod(duration);\r\n        bucket.setRetentionPeriod(duration, callback);\r\n    }\r\n}\r\nexport const setRetentionPeriod: ofBucket<'setRetentionPeriod'> = _setRetentionPeriod;\r\nfunction _setStorageClass<OPTIONS extends SetBucketStorageClassOptions>(bucket: Bucket): (storageClass: string, options?: OPTIONS) => Promise<SetBucketMetadataResponse>;\r\nfunction _setStorageClass<CALLBACK extends SetBucketStorageClassCallback>(bucket: Bucket): (storageClass: string, callback: CALLBACK) => void;\r\nfunction _setStorageClass(bucket: Bucket): (storageClass: string, options: SetBucketStorageClassOptions, callback: SetBucketStorageClassCallback) => void;\r\nfunction _setStorageClass(bucket: Bucket) {\r\n    return (storageClass: string, options?: SetBucketStorageClassOptions, callback?: SetBucketStorageClassCallback) => {\r\n        if (!options)\r\n            return bucket.setStorageClass(storageClass);\r\n        if (!callback)\r\n            return bucket.setStorageClass(storageClass, options);\r\n        return bucket.setStorageClass(storageClass, options, callback);\r\n    }\r\n}\r\nexport const setStorageClass: ofBucket<'setStorageClass'> = _setStorageClass;\r\n\r\nexport const setUserProject: ofBucket<'setUserProject'> = (bucket) => (userProject: string) => bucket.setUserProject(userProject);\r\nfunction _upload<OPTIONS extends UploadOptions>(bucket: Bucket): (pathString: string, options?: OPTIONS) => Promise<UploadResponse>;\r\nfunction _upload(bucket: Bucket): (pathString: string, options: UploadOptions, callback: UploadCallback) => void;\r\nfunction _upload<CALLBACK extends UploadCallback>(bucket: Bucket): (pathString: string, callback: CALLBACK) => void;\r\nfunction _upload(bucket: Bucket) {\r\n    return (pathString: string, options: UploadOptions, callback?: UploadCallback) => {\r\n        if (!options)\r\n            return bucket.upload(pathString);\r\n        if (!callback)\r\n            return bucket.upload(pathString, options);\r\n        return bucket.upload(pathString, options, callback);\r\n    }\r\n}\r\nexport const upload: ofBucket<'upload'> = _upload\r\n\r\ndeclare type MakeAllFilesPublicPrivateResponse = [File[]];\r\nfunction _makeAllFilesPublicPrivate_<OPTIONS extends MakeAllFilesPublicPrivateOptions>(bucket: Bucket): (options?: OPTIONS) => Promise<MakeAllFilesPublicPrivateResponse>;\r\nfunction _makeAllFilesPublicPrivate_<CALLBACK extends MakeAllFilesPublicPrivateOptions>(bucket: Bucket): (callback: CALLBACK) => void;\r\nfunction _makeAllFilesPublicPrivate_(bucket: Bucket) {\r\n    return (options?: MakeAllFilesPublicPrivateOptions) => {\r\n        return bucket.makeAllFilesPublicPrivate_(options)\r\n    }\r\n}\r\nexport const makeAllFilesPublicPrivate_: ofBucket<'makeAllFilesPublicPrivate_'> = _makeAllFilesPublicPrivate_\r\n\r\n\r\nexport const getId: ofBucket<'getId'> = (bucket) => () => bucket.getId();\r\n\r\n","import {storage} from \"firebase-admin\";\r\nimport Storage = storage.Storage;\r\nexport interface MappedStorage extends Omit<Storage,'name'> {\r\n    // omits name\r\n}\r\ntype ofStorage<X extends keyof Storage> = (bucket: Storage) => Storage[X];\r\nexport const app:ofStorage<'app'> = (storage: Storage) => storage.app\r\nexport const bucket:ofStorage<'bucket'> = (storage: Storage) => (name?:string) => {\r\n    if(!name)\r\n        return storage.bucket()  \r\n    return storage.bucket(name)\r\n}\r\nexport default bucket;","\r\nimport * as file from \"./file\"\r\nimport * as bucket from \"./bucket\"\r\nimport * as storage from \"./storage\"\r\nimport { applySpec, pipe } from 'ramda';\r\nimport attachToDefault from \"../attachToDefault\";\r\nimport { File as BucketFile, Bucket as StorageBucket, FileOptions, CreateReadStreamOptions } from 'firebase-admin/node_modules/@google-cloud/storage';\r\nimport { Readable } from \"stream\";\r\nimport {storage as firebaseStorage} from \"firebase-admin\";\r\nimport FirebaseStorage = firebaseStorage.Storage;\r\n\r\nexport type File = file.MappedFile & ((options?: CreateReadStreamOptions) => Readable) // from now on we have a function called File\r\nexport type Bucket = bucket.MappedBucket & ((name: string, options?: FileOptions) => File) // from now on we have a function called Bucket leading to File \r\nexport type Storage = storage.MappedStorage & ((name?:string) => Bucket) // from now on we have a function called Storage leading to Bucket \r\nexport {file,bucket,storage};\r\n \r\nexport const File: (s:BucketFile)=>File = pipe(\r\n    applySpec(file),\r\n    attachToDefault,\r\n);\r\nexport const Bucket: (s:StorageBucket)=>Bucket = pipe(\r\n    applySpec(bucket),\r\n    ({name,...spec}) => ({\r\n        ...spec,\r\n        default: pipe(spec.default, File)\r\n    }),\r\n    attachToDefault\r\n);\r\nexport const Storage: (s:FirebaseStorage)=>Storage = pipe(\r\n    applySpec(storage),\r\n    (spec) => ({\r\n        ...spec,\r\n        default: pipe(spec.default, Bucket)\r\n    }),\r\n    attachToDefault\r\n);\r\n\r\nexport default Storage","import Firestore from './firestore'\r\nimport Storage from './storage'\r\nimport admin = require('firebase-admin')\r\nimport {omit} from 'ramda';\r\n\r\nexport type App = (() => Firestore) & {firestore:()=>Firestore,storage:()=>Storage} & Omit<admin.app.App,'name'>\r\nexport type AppFn = (FirebaseApp: admin.app.App) => App\r\n/**\r\n * Returns functions of firebase.app that can either be chained by key reference or called directly\r\n * The difference between this one and mappedApp is that this works without mapping all the functions of firebase admin\r\n * to a actual function but instead uses the original object, making it more future proof but less deterministic.\r\n */\r\nconst App: AppFn = (FirebaseApp) => Object.assign(\r\n    () => Firestore(FirebaseApp.firestore()),\r\n    omit(['name'],FirebaseApp),\r\n    {\r\n        firestore: () => Firestore(FirebaseApp.firestore()),\r\n        storage: () => Storage(FirebaseApp.storage())\r\n    }\r\n)\r\n\r\nexport default App;","import { pipe, applySpec } from 'ramda'\r\nimport * as image from './image'\r\nimport * as crud from './crud'\r\nimport App from './extendedApp'\r\n// or\r\n// import App from './mapped'\r\n\r\nexport const Image = applySpec(image)\r\n\r\n\r\nexport default pipe(\r\n    App,\r\n    (app) => {\r\n        const File = app.storage()()\r\n        const collection = app.firestore()\r\n        const Stats = collection('stats')\r\n        return {\r\n            ...app,\r\n            Stats,\r\n            Image: pipe(\r\n                collection('images'),\r\n                crud.newCrud(Stats),\r\n                applySpec(\r\n                    applySpec(image)(File)\r\n                ),\r\n            )\r\n        }\r\n    },\r\n);","\r\ninterface HTTPErrorConstructor {\r\n    new(code: number, message?: string, extras?: object);\r\n}\r\ninterface HTTPErrorInterface extends Error {\r\n    statusCode: number\r\n    extras: object\r\n}\r\nconst STATUS_CODES = { '404': 'NotFound', '500': 'InternalServerError' }\r\n\r\nexport const HTTPError: HTTPErrorConstructor = class HTTPError extends Error implements HTTPErrorInterface {\r\n    statusCode\r\n    extras\r\n    constructor(code, message, extras) {\r\n        super(message || STATUS_CODES[code]);\r\n        this.extras = extras || {};\r\n        this.statusCode = code;\r\n    }\r\n}\r\nexport default HTTPError","type StringToNumberOrRandom = (_input: string | string[], max: number) => number\r\ntype GetRandom = (min: number, max: number) => number\r\ntype GetRandomPaddedInt = (min: number, max: number, pad?: number) => string\r\n\r\nexport const stringToNumberOrRandom: StringToNumberOrRandom = (input, max) => {\r\n    const int = parseInt(Object.values(input).join('').replace(/\\D/g, '')) // may only be a integer\r\n    if (isNaN(int) || int > max) return getRandomInt(1, max) // random fallbackk\r\n    return int\r\n}\r\n\r\nexport const getRandomInt: GetRandom = (min, max) => {\r\n    min = Math.ceil(min);\r\n    max = Math.floor(max);\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\nexport const getRandom: GetRandom = (min, max) => {\r\n    return Math.random() * (max - min) + min\r\n}\r\n\r\nexport const getRandomPaddedInt: GetRandomPaddedInt = (min, max, pad = 4) => {\r\n    return String(getRandomInt(min, max)).padStart(pad, '0')\r\n}","export const dev = Boolean(process.env.FUNCTIONS_EMULATOR);\r\nexport const location = 'us-central1'\r\nexport const FIREBASE_CONFIG = JSON.parse(process.env.FIREBASE_CONFIG || '')\r\nexport const IMAGE_VERSIONS = [{\r\n    type: 'x3',\r\n    width: 1800,\r\n    height: 2400\r\n},\r\n{\r\n    type: 'x2',\r\n    width: 1200,\r\n    height: 1600\r\n},\r\n{\r\n    type: 'x1',\r\n    width: 600,\r\n    height: 800\r\n},\r\n{\r\n    type: 'thumb',\r\n    width: 400,\r\n    height: 250\r\n},\r\n]","/**\r\n * This file is a standalone utility for uploading files with the uploadBusboy library.\r\n * Busboy is a parser that reads all uploaded files. Through configuration it is possible\r\n * to \r\n * \r\n * \r\n * Notes for reading this code: \r\n * - Every function is extensively typed. Each function respects it's definition written above it without unneccerary typecasting.\r\n * - Types from the config object should and will be reflected wherever you'd expect. This did require a lot of explaining to typescript. This is fine, because\r\n *      it means explicit type output for end-users of this utility. This is useful when configuring this utility. For example, all return types of the functions\r\n *      assigned to `onFile` will be reflected.\r\n *  @example\r\n *  ```\r\n *  const uploadBusboy = createUploadBusboy(request,{\r\n        onFile: {\r\n            test: ()=>({\r\n                thisisresolved:new Promise(resolve=>resolve('some value'))\r\n            })\r\n        }\r\n    })\r\n    await uploadBusboy((c)=>{\r\n        console.log(c)\r\n        // ^ hover over this variable, and see:\r\n        //                  v notice here, all values are wrapped with `resolved`, which unpacks Promises\r\n        // (parameter) c: resolved<Promise<{\r\n        //     thisisresolved: Promise<string>;\r\n        // }> & {\r\n        //     destination: Promise<string>;\r\n        // } & {\r\n        //     buffer: Promise<Buffer>;\r\n        // } & {\r\n        //     fieldname: string;\r\n        //     file: NodeJS.ReadableStream;\r\n        //     filename: string;\r\n        //     encoding: string;\r\n        //     mimetype: string;\r\n        // }>\r\n    });\r\n\r\n *  ```\r\n *      \r\n * - HOC (Higher Order Functions) are prefixed with 'create'\r\n * - Every function has a comment, these should show up when hovering over these types with something like vscode\r\n * - The only (non-native) dependency is `busboy`\r\n */\r\n\r\n/** Generic function used together with extends */\r\ntype AnyFunction = (...args: any[]) => any\r\n\r\n/** Trick that turns `A | B | C` to `A & B & C` */\r\ntype UnionToIntersection<U> = (U extends any ? (k: U) => void : never) extends ((k: infer I) => void) ? I : never;\r\n\r\n/** Combined functions of array as one function */\r\ntype unifiedFunction<O extends AnyFunction[]> = (...args: Parameters<O[number]>) => UnionToIntersection<ReturnType<O[number]>>\r\n\r\ntype _createUnifiedFunction = <O extends Array<AnyFunction>>(...fns: O) => unifiedFunction<O>\r\n/** Returns a function that recursively calls all functions in a array -with the same arguments- and combines results */\r\nconst _createUnifiedFunction: _createUnifiedFunction = (...fns) => fns.reduce(\r\n    (prev, creator) => (...args) => Object.assign(prev(...args), creator(...args))\r\n    , () => ({})\r\n)\r\n\r\n/** A unified type of two objects*/\r\ntype merged<y, x> = {\r\n    [k in (keyof y | keyof x)]: k extends keyof x\r\n    ? x[k]\r\n    : k extends keyof y ? y[k]\r\n    : never\r\n}\r\ntype _merge = <x, y>(y: y, x: x) => merged<y, x>\r\n/** Merge two objects and cast to a more readable type definition (seen when hovering over things) */\r\nconst _merge: _merge = (y, x) => Object.assign(y, x) as merged<typeof y, typeof x>\r\n\r\n/** \r\n * Adds the ability to call a function without arguments which will return the history of the function.\r\n * This makes the function impure and thus hard for Typescript to reason about, but it does add some cool functionality,\r\n * namely state. This impurity is eleviated by typecasting to the original function(s) (meaning the function passed in to the store function)\r\n */\r\ntype store<T extends AnyFunction> = {\r\n    (...funcArgs: Parameters<T>): ReturnType<T>\r\n    (): { [k: string]: ReturnType<T>[] }\r\n}\r\n\r\ntype createStore = <T extends AnyFunction>(func: T) => store<T>\r\n/**\r\n * Upgrades a function to store and list all previous results.\r\n * \r\n * @remarks\r\n * The upgraded function will behave like the original when called with arguments, but will list a object\r\n * containing all previous results when called without arguments. Each result\r\n * will be keyed by their first argument, which must always be a string. A key can have multiple\r\n * results, which is why all results are stored in a array.\r\n * ```ts\r\n * const create = (fieldname,value)=>({[fieldname]:value})\r\n * const myStore = _createStore(create)\r\n * myStore('A','some')\r\n * myStore('B','values')\r\n * console.log(myStore('A','thing')) // {A:'thing'}\r\n * console.log(myStore()) // { A: [{A:'some'},{A:'thing'}], B: [{B:'values'}] }\r\n * ```\r\n */\r\nconst _createStore: createStore = (func, obj = {} as any) => (...args: any[]) => {\r\n    if (!args.length || !obj) return obj\r\n    const r = func(...args);\r\n    obj = {\r\n        ...obj,\r\n        [args[0]]: [\r\n            ...(obj[args[0]] || []),\r\n            r\r\n        ],\r\n    }\r\n    return r;\r\n}\r\n\r\n\r\n/** Wraps each value of a object with store, see @see store */\r\ntype wrappedFunctionObject<T extends AnyFunction, O extends { [k: string]: any }> = { [k in keyof O]: T extends (fn: O[k]) => infer U ? U : never }\r\n\r\ntype _wrapFunctionObject = <T extends AnyFunction, O extends { [k: string]: any }>(func: T, obj: O) => wrappedFunctionObject<T, O>\r\nconst _wrapFunctionObject: _wrapFunctionObject = (func, obj) =>\r\n    Object.entries(obj)\r\n        .reduce(\r\n            (prev, [key, value]) => Object.assign(prev, { [key]: func(value) }),\r\n            <typeof obj>{}\r\n        )\r\n\r\n\r\n/** Wraps each value of a object with store, see @see store */\r\ntype wrappedStore<O extends { [k: string]: any }> = { [k in keyof O]: store<O[k]> }\r\n\r\n/**\r\n * Wraps all values of a object in a store type\r\n * todo: make the store function generic somehow, this is hard\r\n * because our store function has two signatures (with and without parameters)\r\n */\r\ntype _wrapStore = <O extends { [k: string]: any }>(obj: O) => wrappedStore<O>\r\nconst _wrapStore: _wrapStore = (obj) => _wrapFunctionObject(_createStore, obj)\r\n\r\n/** Generic function for files */\r\ntype AnyFileFunction<RETURN> = (fieldname: string, file: NodeJS.ReadableStream, filename: string, encoding: string, mimetype: string) => RETURN\r\n\r\n/** filesCreate turns file arguments in to a object */\r\ntype files = AnyFileFunction<{\r\n    fieldname: string\r\n    file: NodeJS.ReadableStream\r\n    filename: string\r\n    encoding: string\r\n    mimetype: string\r\n}>\r\nconst _files: files = (fieldname, file, filename, encoding, mimetype) => ({\r\n    fieldname,\r\n    file,\r\n    filename,\r\n    encoding,\r\n    mimetype\r\n})\r\ntype fileWrites = AnyFileFunction<{ destination: Promise<string> }>\r\n/**\r\n * Turns file and filename argument in to a writestream in a folder\r\n * NOTE: this one has a depenceny on utils, which is a extra function call\r\n */\r\ntype fileWritesCreate = () => fileWrites\r\nconst _fileWritesCreate: fileWritesCreate = () => {\r\n    const createWriteStream = require('fs').createWriteStream;\r\n    const join = require('path').join;\r\n    const tmpdir = require('os').tmpdir\r\n    return (...args) => ({\r\n        destination: new Promise((resolve, reject) => {\r\n            const destination = join(tmpdir(args[0]), args[3]);\r\n            const writeStream = createWriteStream(destination);\r\n            args[1].pipe(writeStream);\r\n            args[1].on('end', () => { writeStream.end(); });\r\n            writeStream.on('finish', () => resolve(destination));\r\n            writeStream.on('error', reject);\r\n        })\r\n    })\r\n}\r\n\r\n/** Default function to create a file buffer */\r\ntype fileBuffers = AnyFileFunction<{ buffer: Promise<Buffer> }>\r\nconst _fileBuffers: fileBuffers = (_, file) => ({\r\n    buffer: new Promise<Buffer>((resolve, reject) => {\r\n        const imgResponse: Uint8Array[] = [];\r\n        file.on('store', (store) => {\r\n            imgResponse.push(store);\r\n        });\r\n        file.on('end', () => {\r\n            resolve(Buffer.concat(imgResponse));\r\n        });\r\n        file.on('error', reject);\r\n    })\r\n})\r\n\r\n/** Default listeners for files (may be extended through config) */\r\ntype onFile = {\r\n    fileWrites: fileWrites,\r\n    fileBuffers: fileBuffers,\r\n    files: files,\r\n}\r\n\r\n/** Generic function for fields */\r\ntype AnyFieldFunction<RETURN> = (fieldname: string, val: any, fieldnameTruncated: boolean, valTruncated: boolean, encoding: string, mimetype: string) => RETURN\r\n\r\ntype fields = AnyFieldFunction<{\r\n    fieldname: string,\r\n    val: any,\r\n    fieldnameTruncated: boolean,\r\n    valTruncated: boolean,\r\n    encoding: string,\r\n    mimetype: string\r\n}>\r\n/** Turns field arguments in to a object with named keys */\r\nconst _fields: fields = (fieldname, val, fieldnameTruncated, valTruncated, encoding, mimetype) => ({\r\n    fieldname,\r\n    val,\r\n    fieldnameTruncated,\r\n    valTruncated,\r\n    encoding,\r\n    mimetype\r\n})\r\n\r\n/** Default listeners for fields (may be extended through config) */\r\ntype onField = {\r\n    fields: fields\r\n}\r\n\r\n/** Object.values equivalent for typescript */\r\ntype valuesOf<T extends object> = T extends { [k in keyof T]: infer U } ? U[] : never\r\n\r\n/** the default configuration of createUploadBusboy */\r\nexport type ConfigDefaults = {\r\n    onFile: onFile\r\n    onField: onField\r\n};\r\n\r\n/** the configuration given by a programmer */\r\nexport type Config = {\r\n    onFile?: { [k: string]: AnyFileFunction<any> }\r\n    onField?: { [k: string]: AnyFieldFunction<any> }\r\n}\r\n\r\n\r\n\r\n/** A accurate definition of merged config, reflects any possible configuration */\r\nexport type mergedConfig<C extends Config> = {\r\n    onFile: merged<onFile, (C[\"onFile\"] extends { [k: string]: AnyFileFunction<any> } ? C[\"onFile\"] : Config)>\r\n    onField: merged<onField, (C[\"onField\"] extends { [k: string]: AnyFieldFunction<any> } ? C[\"onField\"] : Config)>\r\n}\r\n\r\ntype functionObject = { [k: string]: AnyFunction }\r\n/** Test to see if a object only contains functions */\r\nfunction isFunctionObject<O extends functionObject>(o: any): o is O\r\nfunction isFunctionObject<O>(o: any) {\r\n    return typeof o === 'object' && Object.values(o).findIndex(func => typeof func !== 'function') === -1;\r\n}\r\n\r\n/** `createUploadBusboy config property 'onFile|utils|onField' should be a object that only contains functions` */\r\nconst fnsOnlyErr = (name: string) => new Error(`createUploadBusboy config property \\'${name}\\' should be a object that only contains functions`)\r\n\r\n/** A inbetween state of merging config type definitions, either this or that */\r\ntype simpleMergedConfig<C extends Config> = {\r\n    onFile: C['onFile'] | onFile\r\n    onField: C['onField'] | onField\r\n}\r\n\r\ntype _mergeConfig = <C extends Config>(config?: C) => mergedConfig<C>\r\n/** Assigns all the default functions to the config object */\r\nconst _mergeConfig: _mergeConfig = (config = {} as any) => {\r\n    if (!isFunctionObject(config.onFile)) throw (fnsOnlyErr('onFile'))\r\n    if (!isFunctionObject(config.onField)) throw (fnsOnlyErr('onField'))\r\n    return {\r\n        onField: _merge(\r\n            <onField>{\r\n                fields: _fields\r\n            },\r\n            config.onField || {}\r\n        ),\r\n        onFile: _merge(\r\n            <onFile>{\r\n                fileWrites: _fileWritesCreate(),\r\n                fileBuffers: _fileBuffers,\r\n                files: _files\r\n            },\r\n            config.onFile || {}\r\n        )\r\n    } as simpleMergedConfig<typeof config> as mergedConfig<typeof config>\r\n}\r\n\r\n\r\n/** infers the return type of a Promise */\r\ntype Unpacked<T> =\r\n    T extends (infer U)[] ? U :\r\n    T extends (...args: any[]) => infer U ? U :\r\n    T extends Promise<infer U> ? U :\r\n    T;\r\n\r\ntype _newBusboy = (busboyConfig: busboy.BusboyConfig) => busboy.Busboy;\r\n/** creates a new instance of busboy class */\r\nconst _newBusboy: _newBusboy = busboyConfig => new (require('busboy'))(busboyConfig)\r\n\r\n/** infers the return type of Promises attached to a object */\r\ntype resolved<T extends any> = { [s in keyof T]: Unpacked<T[s]>; }\r\n\r\n/**\r\n * Turns all promise-values of a object in to a single promise returning the object with values resolved\r\n */\r\ntype resolver = <T extends { [k: string]: any }>(obj: T) => Promise<resolved<T>>\r\nconst resolver: resolver = async obj => {\r\n    for (let key in obj)\r\n        if (obj.hasOwnProperty(key) && typeof obj[key].then === 'function')\r\n            obj[key] = await obj[key];\r\n    return obj;\r\n}\r\n\r\n/** The results of the start function without any config changes */\r\nexport type defaultResults = resolved<ReturnType<mergedConf<functionObject>>[]>\r\n\r\n/** The combination of default configuration and the configuration given by a end-user -if any- as a array */\r\ntype mergedConf<ONFILE extends functionObject> = unifiedFunction<valuesOf<ONFILE>>\r\n\r\n/** The api facing a end-user of createUploadBusboy, this the returnType of createUploadBusboy */\r\ntype api<C extends Config, MC extends mergedConfig<C>, ONFILEVALUES extends valuesOf<MC['onFile']>> = {\r\n    busboy: busboy.Busboy\r\n    onFile: ONFILEVALUES extends AnyFunction[] ? store<unifiedFunction<ONFILEVALUES>> : never\r\n    start: start<ONFILEVALUES extends AnyFunction[] ? unifiedFunction<ONFILEVALUES> : never>\r\n} & wrappedStore<MC['onField']> & wrappedStore<MC['onFile']> & start<ONFILEVALUES extends AnyFunction[] ? unifiedFunction<ONFILEVALUES> : never>\r\n\r\n/** The start function with and without callback */\r\ntype start<ONFILEFN extends any> = {\r\n    <CB extends ((done: resolved<ONFILEFN>) => any)>(cb: CB): Promise<resolved<ReturnType<CB>[]>>\r\n    (): Promise<resolved<ONFILEFN>[]>\r\n}\r\n\r\ntype _createApi = <R extends { rawBody: any, headers: object }, C extends Config>(request: R, config?: C) => api<C,mergedConfig<C>,valuesOf<mergedConfig<C>['onFile']>>\r\n\r\n/** Creates the api facing the end-user of this utility.\r\n *  The api/interface is actually just a function, but also has utility-functions attached to it; think \"callable object\"\r\n */\r\nconst _createApi: _createApi = (request, config) => {\r\n    /** mc is the combination of default configuration and the configuration of a end-user of this utility*/\r\n    const mc = _mergeConfig(config)\r\n    /** Basically does `new Busboy`, so unless you have a good reason the default should be desired.  */\r\n    /** The busboy instance */\r\n    const busboy = _newBusboy({ headers: request.headers })\r\n    /** All the onFile functions wrapped with store (default: files,fileWrites,fileBuffers) */\r\n    const onFileSubStores = _wrapStore(mc.onFile)\r\n    /** All the onField functions wrapped with store (default: fields) */\r\n    const onFieldSubStores = _wrapStore(mc.onField)\r\n    /** `handleOnFile` is a function that calls, merges and stores results of all file functions.\r\n     * When `handleOnFile` is called with arguments: all substores will be called with these same arguments and the results will be merged to one object.\r\n     * When `handleOnFile` is called without arguments: all the previous (merged) results will be returned as a array.\r\n    */\r\n    const handleOnFile = _createStore(\r\n        _createUnifiedFunction(\r\n            /**  \r\n             * Calling a substore without arguments can't be done from within this unified function,\r\n             * and it wouldn't make sense to do so. That is why onFileSubstores is typecasted back to `mc['onFile']`\r\n            */\r\n            ...Object.values(onFileSubStores as typeof mc['onFile'])\r\n        )\r\n    )\r\n    /** `handleOnField` is a function that calls, merges and stores results of all field functions. */\r\n    const handleOnField = _createStore(\r\n        _createUnifiedFunction(\r\n            ...Object.values(onFieldSubStores as typeof mc['onField'])\r\n        )\r\n    )\r\n    /** `start` is the function that puts everything in motion. */\r\n    const start = async (cb?: AnyFunction) => {\r\n        const filePromises: any[] = []\r\n        const handler = (typeof cb === 'function')\r\n            ? <P extends Promise<any>>(done: P) => filePromises.push(done.then(cb))\r\n            : <P extends Promise<any>>(done: P) => filePromises.push(done);\r\n        const promise = new Promise<void>((resolve, reject) => {\r\n            busboy.on('finish', resolve)\r\n            busboy.on('partsLimit', reject)\r\n            busboy.on('filesLimit', reject)\r\n            busboy.on('fieldsLimit', reject)\r\n        });\r\n        if (handleOnField()) busboy.on('field', handleOnField)\r\n        if (handleOnFile()) busboy.on('file', (...args) => {\r\n            handler(resolver(handleOnFile(...args)))\r\n        })\r\n        busboy.end(request.rawBody) // start busboy\r\n        await promise\r\n        return Promise.all(filePromises);\r\n    }\r\n    return Object.assign(start, {\r\n        ...onFileSubStores,\r\n        ...onFieldSubStores,\r\n        busboy,\r\n        onFile: handleOnFile,\r\n        onField: handleOnField,\r\n        start\r\n    })\r\n}\r\n\r\n/**\r\n * Configures a function that can be used to process incomming uploaded files\r\n * \r\n * @note This is a alias for `_createApi` @see _createApi\r\n * \r\n * @param request   the request object containing atleast rawBody (any) and headers (object)\r\n * @param config    a optional configuration object. @see Config\r\n */\r\nexport const createUploadBusboy: _createApi = _createApi\r\n\r\nexport default createUploadBusboy","import asciify = require('asciify-image')\r\nexport const logAscii = async (img: Buffer, msg?: string) => {\r\n    console.log(msg)\r\n    console.log(await asciify(img, {\r\n        fit: 'box',\r\n        width: 16,\r\n        height: 16\r\n    }))\r\n};","import sharp = require('sharp')\r\nimport { IMAGE_VERSIONS, dev } from \"~contants\";\r\nimport { imageSize } from \"image-size\";\r\nimport {createHash, HexBase64BinaryEncoding} from 'crypto'\r\nimport automl = require('@google-cloud/automl');\r\nimport { FIREBASE_CONFIG, location } from \"~contants\";\r\nimport { logAscii } from \"~tools/ascii\";\r\nimport functionalFbAdmin from '~functional-firebase-admin/core';\r\nimport {app} from \"firebase-admin\";\r\n\r\nconst { firestore, storage, Image, Stats} = functionalFbAdmin(app())\r\nconst collection = firestore();\r\nconst defaultBucket = storage()();\r\ninterface File {\r\n    destination: string\r\n    buffer: Buffer\r\n    fieldname: string\r\n    file: NodeJS.ReadableStream;\r\n    filename: string\r\n    encoding: string\r\n    mimetype: string\r\n}\r\n// taken from https://cloud.google.com/nodejs/docs/reference/automl/0.1.x/google.cloud.automl.v1beta1#.AnnotationPayload\r\n// probably changes in the future\r\ntype AnnotationPayload = {\r\n    translation: {\r\n        translatedContent:{\r\n            content:string,\r\n            mimeType:string,\r\n            contentUri:string,\r\n        }\r\n    },\r\n    classification: {\r\n        score: number\r\n    },\r\n    annotationSpecId: string,\r\n    displayName: string\r\n}\r\ntype PredictResponse = {\r\n    payload:AnnotationPayload[],\r\n    metadata: {[key:string]:any},\r\n    preprocessedInput: any\r\n}\r\n\r\nconst predictionClient = new automl.v1beta1.PredictionServiceClient();\r\nconst project = FIREBASE_CONFIG.projectId;\r\nconst automl_model = {\r\n    'mooiemanOrFraaievrouw':'ICN4428727672790743256'\r\n}\r\nexport function analysePhoto(b64img:string, type:keyof typeof automl_model): Promise<PredictResponse[]> {\r\n    return new Promise((resolve, reject) => {\r\n        const payload = {\r\n            \"image\": {\r\n                \"imageBytes\": b64img\r\n            }\r\n        }\r\n        const reqBody = {\r\n            name: predictionClient.modelPath(project, location, automl_model[type]),\r\n            payload: payload\r\n        }\r\n        predictionClient.predict(reqBody)\r\n            .then((responses:PredictResponse[]) => {\r\n                console.log('Got a prediction from AutoML API!');\r\n                resolve(responses);\r\n                return responses\r\n            })\r\n            .catch((err:string) => {\r\n                console.log('AutoML API Error: ', err);\r\n                reject(err);\r\n            });\r\n    });\r\n}\r\n\r\nconst sharpClone = (tobeCloned: sharp.Sharp, version: { width: number, height: number, type: string }) =>\r\n    Object.assign(\r\n        tobeCloned.clone().resize(\r\n            version.width, version.height, { fit: 'inside', withoutEnlargement: true }\r\n        ),\r\n        version\r\n    )\r\n\r\nconst generateImageVersions = (baseSharp: sharp.Sharp) => {\r\n    const [maxVersion, ...smallerVersions] = IMAGE_VERSIONS\r\n    return smallerVersions.reduce(\r\n        ([prev, ...rest], version) => [\r\n            sharpClone(prev, version), // and use the previous to downscale even further\r\n            prev,\r\n            ...rest,\r\n        ]\r\n        , [sharpClone(baseSharp, maxVersion)] // we start with the biggest\r\n    )\r\n}\r\n\r\nexport const create = async (file:File, modelType:keyof typeof automl_model = 'mooiemanOrFraaievrouw') => {\r\n    const {buffer, filename, mimetype} = file\r\n    const md5 = createHash('md5').update(buffer).digest(\"hex\")\r\n    const {width=0,height=0,type:ext='jpg'} = imageSize(buffer)\r\n    const versions = generateImageVersions(sharp(buffer).rotate())\r\n    const snapshot = await collection('images')(md5).get()\r\n    if (snapshot.exists) throw (new Error(`This image has already been fromFileed: ${snapshot.get('normal')}`))\r\n    \r\n    const [automlResponse] = await analysePhoto((await versions[2].toBuffer()).toString('base64'), modelType) // use the 600 version to predict mooieman or fraaievrouw\r\n    const [payload] = automlResponse.payload;\r\n    const type = (payload.displayName === 'mooieman' || payload.displayName === 'fraaievrouw') ? payload.displayName : 'none'\r\n    const count = await Stats(type)('count').get()\r\n    if (dev) await logAscii((await versions[3].toBuffer()), `${payload.displayName} (${payload.classification.score})`) // use the thumb to generate a ascii for the developer\r\n    const baseImg = {\r\n        md5,\r\n        originalFilePath: `${type}/${md5}.${ext}`,\r\n        originalFileName: `${filename}`,\r\n        originalFileMime: mimetype,\r\n        originalWidth: width,\r\n        originalHeight: height,\r\n        type,\r\n        score: payload.classification.score,\r\n    }\r\n    const mainUpload = Image(md5).create({\r\n        ...baseImg,\r\n        fileName:md5,\r\n        filePath: `${type}/${md5}.${ext}`,\r\n        fileMime: mimetype, // will keep as is\r\n        upload: buffer,\r\n        width,\r\n        height,\r\n        ext\r\n    });\r\n    await Promise.all(versions.map(\r\n        version =>\r\n            Image(md5).createVersion({\r\n                filePath: `${type}/${type + String(count).padStart(4, '0')}.webp`,\r\n                fileMime: 'image/webp', // fromFile version images as webp to save space (25 – 35%),\r\n                width: version.width,\r\n                height: version.height,\r\n                upload: version.webp(),\r\n            }))\r\n    )\r\n    await mainUpload;\r\n    return 'hi'\r\n}\r\nexport default create","import { https as httpsFunction, storage as storageFunction } from 'firebase-functions';\nimport gqlServer from '~graphql/server';\nimport functionalFbAdmin from '~functional-firebase-admin/core';\nimport admin = require(\"firebase-admin\");\n\nimport express = require('express')\nimport HTTPError from '~tools/errors';\nimport { getRandomInt } from '~tools/numbers';\nimport { FIREBASE_CONFIG, dev } from '~contants';\nimport { createUploadBusboy } from '~tools/uploadBusboy';\nimport { Request } from 'express-serve-static-core';\nimport { logAscii } from '~tools/ascii';\nimport { create, analysePhoto } from '~models/photos';\nimport { flow } from 'fp-ts/lib/function'\n// import mime from 'mime-types'\nvar app = express()\nadmin.initializeApp(FIREBASE_CONFIG)\n\nconst { firestore, storage } = functionalFbAdmin(admin.app())\nconst collection = firestore();\nconst { Image, Stats } = functionalFbAdmin(admin.app())\nconst defaultBucket = storage()();\n\napp.get('/count/:type', async (request, response) => {\n    try {\n        const { params: { type } } = request;\n        console.log('type', type)\n        const snapshot = await Stats(type).get()\n        if (!snapshot.exists) throw (new HTTPError(404, `${type} stats not found`))\n        const data = await snapshot.data();\n        if (!data || !data.count) throw (new HTTPError(404, `${type} count not found`))\n        response.json(data.count)\n    } catch (e) {\n        if (dev) console.log(`error ${Object.values(request.params).join('/')}`)\n        if (dev) console.trace(e)\n        if (typeof e.statusCode === 'number') response.status(e.statusCode).json(e.message)\n    }\n    return response.send()\n})\n\ninterface MooiemanOrFraaievrouwRequest extends Request { params: { type: 'fraaievrouw' | 'mooieman', id: string } };\napp.get('/:type(mooieman|fraaievrouw)/:id(\\\\d+)?', async (\n    request: MooiemanOrFraaievrouwRequest,\n    response\n) => {\n    let { params: { type, id } } = request;\n    const imgResponse: Uint8Array[] = [];\n    try {\n        if (!id || isNaN(parseInt(id))) {\n            const snapshot = await Stats(type).get()\n            if (!snapshot.exists) throw (new HTTPError(404, `${type}/${id} not found`))\n            const data = snapshot.data();\n            if (!data || !data.count) throw (new HTTPError(404, `${type}/${id} count not found`))\n            id = String(getRandomInt(1, data.count))\n        }\n        const createReadStream = await defaultBucket(`${type}/${type}${id.padStart(4, '0')}.jpg`)\n        console.log(Object.keys(createReadStream))\n        if (!createReadStream.exists()) throw (new HTTPError(404, `${type} image not found`))\n        const readStream = createReadStream();\n        if (!readStream) throw (new HTTPError(404, `${type} stream not found`))\n        if (dev) readStream.on('data', (data) => imgResponse.push(data))\n        await new Promise(\n            (resolve, reject) => readStream\n                .on('response', (resp) => response.setHeader('Content-Type', resp.headers['content-type']))\n                .on('error', reject)\n                .on('end', resolve)\n                .pipe(response)\n        );\n        if (dev) await logAscii(Buffer.concat(imgResponse), `Downloaded ${type}/${id}`)\n    } catch (e) {\n        if (dev) console.log(`error ${Object.values(request.params).join('/')}`)\n        if (dev) console.trace(e)\n        if (typeof e.statusCode === 'number') response.status(e.statusCode).json(e.message)\n    }\n    return response.send()\n})\n\n\napp.post('/upload', async (request, response) => {\n    try {\n        const uploadBusboy = createUploadBusboy(request,{\n            onFile: {\n                jimfn: ()=>({jim:'jim'})\n            }\n        })\n        const r = await uploadBusboy((upload)=>{\n            create(upload.jim)\n            return upload\n        });\n        console.log(r)\n        console.log('done')\n        response.json(Object.values(uploadBusboy.files()).flat().map(({file,...other})=>other))\n    } catch (e) {\n        if (dev) console.log(`error ${Object.values(request.params).join('/')}`, e.message)\n        if (dev) console.trace(e)\n        if (typeof e.statusCode === 'number') response.status(e.statusCode).json(e.message)\n    }\n    return response.send()\n})\n\n\n// http://localhost:5001/mooie-man/us-central/graphql/\n// https://us-central1-mooie-man.cloudfunctions.net/graphql/\nexport const graphql = httpsFunction.onRequest(gqlServer({\n\n}));\n// http://localhost:5001/mooie-man/us-central/count/\n// https://us-central1-mooie-man.cloudfunctions.net/count/\nexport const count = httpsFunction.onRequest(app)\n// http://localhost:5001/mooie-man/us-central/mooieman/\n// https://us-central1-mooie-man.cloudfunctions.net/mooieman/\nexport const mooieman = httpsFunction.onRequest(app)\n// http://localhost:5001/mooie-man/us-central/fraaievrouw/\n// https://us-central1-mooie-man.cloudfunctions.net/fraaievrouw/\nexport const fraaievrouw = httpsFunction.onRequest(app)\n// http://localhost:5001/mooie-man/us-central/manualUpload/\n// https://us-central1-mooie-man.cloudfunctions.net/manualUpload/\nexport const upload = httpsFunction.onRequest(app)\nexport const uploadFinalize = storageFunction.object().onFinalize((event) => {\n    console.log('uploadFinalize')\n});"]}