<!DOCTYPE html>
<html>

<head>
  <title>Mooie Man</title>
  <meta name="fb:page_id" content="142161662532719" />
  <meta name="keywords"
    content="mooie mannen,knappe mannen,knappe man,beautiful men,beautiful man,pretty man,handsome man,sexy mannen,sexy men,plaatjes,portretten">
  <!-- ie9 polyfills -->
  <style type="text/css">
    iframe {
      position: fixed;
      top: 46px;
      left: 20px;
    }

    #wrapper {
      display: flex;
      justify-content: center;
      justify-items: center;
      width: 100vw;
    }

    .center {
      text-align: center;
      margin: auto;
      padding-top: 5em;
    }

    .fraai {
      position: fixed;
      top: 20px;
      left: 20px;
    }

    img#mooieman {
      margin-top: 10px;
      /* border: 10px solid lightgreen; */
      cursor: pointer;
    }

    img#mooieman.loading {
      cursor: progress;
    }

    img#mooieman.waiting {
      cursor: wait;
    }

    img#mooieman.loaded {
      cursor: pointer;
    }

    img#mooieman:hover {
      transform: scale3d(1.03, 1.03, 1)
    }

    .hidden {
      display: none;
    }
  </style>
  <meta property="og:title" content="Mooie Man" />
  <meta property="og:type" content="public_figure" />
  <meta property="og:url" content="https://www.mooieman.com" />
  <meta property="og:site_name" content="MooieMan.com" />
  <meta property="fb:admins" content="100000517544087" />

  <link rel="preload" class="preload loaded" as="image"
    href="/mooieman/" onload="handleLink(event)"
    onloadstart="handleLink(event)" onabort="handleLink(event)">
</head>

<body>
  <div class=fraai><a href="http://www.fraaievrouw.com" target="_blank">FraaieVrouw.com</a></div>
  <div id="wrapper">
    <div class='center'>
      <h1>Mooie Man</h1>
      <noscript>
        <a href=".">
      </noscript>
      <img style="object-fit: scale-down;" src="/mooieman/"
        id="mooieman" alt="" onclick="handleImg(event)" onload="handleImg(event)" onloadstart="handleImg(event)"
        onabort="handleImg(event)" />
      <noscript>
        </a>
      </noscript>
    </div>
  </div>
  <script type="text/javascript" src="./polyfills/custom-event.js"></script>
  <script type="text/javascript" src="./polyfills/image-link-polyfill.js"></script>
  <script type="text/javascript">
    // returns a url to request a random image 
    var newMooieMan = function newMooieMan() {
      return '/mooieman/'
        + String(
          Math.floor(Math.random() * max) + 1
        )
    }
    // handles events for the img tag
    var handleImg = function handleImg(event) {
      var el = event.target;
      var type = event.type;
      var loaded;
      if (type == 'load') {
        el.classList.remove('loading')
        el.classList.remove('waiting')
        el.classList.add('loaded')
        el.style.cursor = 'pointer';
      } else if (type == 'loadstart') {
        el.classList.remove('waiting')
        el.classList.remove('loaded')
        el.classList.add('loading')
        el.style.cursor = 'progress';
      } else if (type == 'abort') {
        el.classList.remove('waiting')
        el.classList.remove('loaded')
        el.classList.add('loading')
        el.style.cursor = 'progress';
      } else if (type == 'click' && (loaded = document.head.querySelector('.preload.loaded'))) {
        el.src = loaded.href
        loaded.dispatchEvent(new CustomEvent("abort"));
      } else if (type == 'click') {
        // the user clicked
        el.classList.remove('loading')
        el.classList.remove('loaded')
        el.classList.add('waiting')
        el.style.cursor = 'wait';
        (
          document.head.appendChild(document.head.querySelector('.preload').cloneNode(true))
        ).dispatchEvent(new CustomEvent("abort"));
      }
      if(dev) console.info('handled image', event.target.tagName, event.type, event.target.src)
    }
    // handles events for the link tag
    var handleLink = function handleLink(event) {
      var el = event.target;
      var type = event.type;
      if (type == 'load' && mooieman.classList.contains('waiting')) {
        loadImagePolyfil(function _loadImagePolyfil(mooieman){
          mooieman.src = el.href;
          return mooieman
        }(document.getElementById('mooieman')));
        el.dispatchEvent(new Event("abort"));
      } else if (type == 'load') {
        el.classList.add('loaded')
        el.classList.remove('loading')
      } else if (type == 'loadstart') {
        el.classList.add('loading')
        el.classList.remove('loaded')
      } else if (type == 'abort') {
        el.classList.remove('loaded')
        el.classList.remove('loading')
        el.href = newMooieMan()
        loadImagePolyfil(el);
      }
      if(dev) console.info('handled link', event.target.tagName, event.type, event.target.href)
    }
    var mooiemanApp = function mooiemanApp() {
      Array.from(document.head.getElementsByClassName('preload'))
        .forEach(function (target) {
          target.dispatchEvent(new Event("abort"));
        });
    }

    // runtime
    var loadImagePolyfil = imageLinkPolyfill()
    var dev = (location.hostname === "localhost")
    var max = !dev ? 300 : 3;
    // request the amount of images so we can include all
    if(dev) fetch(new Request('/count/mooieman'))
      .then(function (blob) {
        return blob.json()
      }).then(function (count) {
        max = parseInt(count)
      });
     if(dev) fetch(new Request('/count/fraaievrouw'))
      .then(function (blob) {
        return blob.json()
      }).then(function (count) {
        maxVrouw = parseInt(count)
      });

    document.addEventListener("DOMContentLoaded", mooiemanApp);
  </script>
</body>

</html>